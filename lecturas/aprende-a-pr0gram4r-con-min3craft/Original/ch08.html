<html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ns="http://www.w3.org/2001/10/synthesis">
<head>
<title>Aprende a programar con Minecraft</title>
<link href="../styles/9781593276706.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:40af8c70-d268-482b-9282-0b537fc6ae71" name="Adept.expected.resource"/>
</head>
<body>
<h2 class="h2" id="ch08"><span epub:type="pagebreak" id="page_149"></span><strong><span class="blue1"><span class="big">8</span></span></strong><br translate="no"/><strong>LAS FUNCIONES TE DAN SUPERPODERES</strong></h2>
<div class="image1"><img alt="image" src="../images/common01.jpg" translate="no"/></div>
<p class="noindent">Las funciones son bloques de código reutilizables que realizan tareas específicas. Digamos que quieres escribir código que construya un árbol en Minecraft. Podrías reescribir el código de construcción del árbol cada vez que necesites utilizarlo en tu programa (o copiarlo y pegarlo); sin embargo, esto sería ineficaz, sobre todo si quisieras cambiarlo.</p>
<p class="indent">En lugar de copiar y pegar, podrías escribir el código de construcción del árbol como una <em>función</em>. Recuerda que hemos utilizado algunas funciones en capítulos anteriores: <span class="literal">str()</span>, <span class="literal">input()</span> e <span class="literal">int()</span>. Todas ellas son funciones integradas en Python. Incluso has estado utilizando funciones de Minecraft, como las funciones <span class="literal">getBlocks()</span> y <span class="literal">setPos()</span>, que vienen con la API Python de Minecraft. En este capítulo, crearás tus <em>propias</em> funciones.</p>
<p class="indentb">Creas y utilizas funciones por las siguientes razones:</p>
<p class="hanging"><strong>Reutilización</strong> Las funciones ahorran tiempo. Al no tener que reescribir el mismo código una y otra vez, escribir un programa es más rápido y sencillo.</p>
<p class="hanging"><span epub:type="pagebreak" id="page_150"></span><strong>Depuración</strong> Al contener las tareas en grupos de código, es más fácil identificar dónde se origina un problema y hacer cambios para solucionarlo.</p>
<p class="hanging"><strong>Modularidad</strong> Puedes desarrollar diferentes funciones para utilizarlas en el mismo programa, independientemente unas de otras. Esto facilita compartir código con otras personas y reutilizar funciones en otros programas.</p>
<p class="hanging"><strong>Escalabilidad</strong> Utilizar funciones facilita aumentar el tamaño de un programa y la cantidad de datos que procesa.</p>
<h3 class="h3" id="ch08lev1sec01"><strong><span class="blue1">Definir tus propias funciones</span></strong></h3>
<p class="noindent">Veamos cómo puedes utilizar funciones en tu código. En el siguiente ejemplo, hago una función llamada <span class="literal">saludo()</span> que simplemente imprime dos líneas:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">greeting</span>():<br translate="no"/> <span class="rose">print</span>(<span class="green">"Hello"</span>)<br translate="no"/> <span class="rose">print</span>(<span class="green">"Nice to meet you"</span>)</p>
<p class="indent">La palabra clave <span class="literal">def</span>, que es una abreviatura de <em>definir</em>, indica a Python que estás escribiendo una función. Siempre que quieras escribir una función, debes escribir primero <span class="literal">def</span> seguido del nombre de la función. En este ejemplo, <span class="literal">saludo</span> es el nombre de la función. No olvides añadir los paréntesis y los dos puntos al final de la primera línea. Las líneas que siguen a los dos puntos son el <em>cuerpo</em> de la función, que es el código que se ejecutará cuando se llame a la función.</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTA</span></strong></p>
<p class="notep"><em>Mantén una sangría coherente en tu código. Utiliza siempre cuatro espacios de sangría en el cuerpo de la función.</em></p>
</div>
<p class="indent">Una función puede contener tantas sentencias como quieras. También puede incluir sentencias <span class="literal">if</span>, bucles, variables, condiciones, operadores matemáticos, etc. Cuando llegues al final del código de la función, deja de sangrar las líneas para que Python sepa qué sentencias pertenecen a la función y qué sentencias pertenecen a otras partes de tu código.</p>
<p class="indent">Puedes crear tantas funciones como quieras en un programa, siempre que tengan nombres diferentes.</p>
<h4 class="h4" id="ch08lev2sec01"><strong><span class="blue1">Llamar a una función</span></strong></h4>
<p class="noindent">Para utilizar, o <em>llamar</em>, a una función, escribe el nombre de la función con los argumentos que pueda necesitar entre paréntesis. Si tu función no necesita argumentos, escribe simplemente el nombre de la función y un conjunto de paréntesis vacíos.</p>
<p class="indent">Para llamar a la función <span class="literal">saludo(</span> ) definida anteriormente, utilizarías el siguiente código:</p>
<p class="programs" translate="no">greeting()</p>
<p class="indent"><span epub:type="pagebreak" id="page_151"></span>Puedes llamar a la función tantas veces como quieras. Vamos a llamar a la función <span class="literal">saludo</span> () tres veces:</p>
<p class="programs" translate="no">greeting()<br translate="no"/>greeting()<br translate="no"/>greeting()</p>
<p class="indent">Cuando ejecutes el programa, debería producir la salida de la función tres veces, así:</p>
<p class="programs" translate="no"><span class="blue1">Hello</span><br translate="no"/><span class="blue1">Nice to meet you</span><br translate="no"/><span class="blue1">Hello</span><br translate="no"/><span class="blue1">Nice to meet you</span><br translate="no"/><span class="blue1">Hello</span><br translate="no"/><span class="blue1">Nice to meet you</span></p>
<p class="indent">Debes llamar a la función en el cuerpo de tu código, o la función no hará nada. Esto es un error muy común. Si ejecutas un programa que define algunas funciones y tu código no hace nada, puede deberse a que olvidaste llamar a las funciones que creaste.</p>
<p class="indent">También puedes llamar a funciones desde dentro de otra función que hayas creado. Esto incluye tanto las funciones incorporadas en Python como las que tú hayas creado. Verás esto en acción dentro de un momento.</p>
<h4 class="h4" id="ch08lev2sec02"><strong><span class="blue1">Las funciones reciben argumentos</span></strong></h4>
<p class="noindent">Los paréntesis de una función contienen sus argumentos, que son valores que utiliza la función. Los valores se utilizan para variables específicas dentro de la función cuando ésta se ejecuta. No todas las funciones necesitan argumentos. Por ejemplo, la función <span class="literal">saludo(</span> ) no necesita argumentos.</p>
<p class="indent">Pero supongamos que quiero mostrar un saludo a alguien utilizando su nombre. Escribiré esto como una función para poder reutilizar el código para saludar a distintas personas:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">fancyGreeting</span>(personName):<br translate="no"/> <span class="rose">print</span>(<span class="green">"Hello, "</span> + personName)<br translate="no"/><br translate="no"/>fancyGreeting(<span class="green">"Mario"</span>)<br translate="no"/>fancyGreeting(<span class="green">"Steve"</span>)</p>
<p class="indent">En este ejemplo, la función se llama dos veces utilizando argumentos diferentes, <span class="literal">"Mario"</span> y <span class="literal">"Steve"</span>. Cuando ejecutas el programa, la salida tiene este aspecto:</p>
<p class="programs" translate="no"><span class="blue1">Hello, Mario</span><br translate="no"/><span class="blue1">Hello, Steve</span></p>
<p class="indent">Si olvidas incluir un argumento cuando llamas a una función que necesita uno, obtendrás un error. Además, si una función necesita varios argumentos <span epub:type="pagebreak" id="page_152"></span>y te olvidas de incluir aunque sólo sea uno de ellos, obtendrás un error. Por ejemplo, intentemos llamar a la función <span class="literal">fancyGreeting(</span> ) sin argumentos, así:</p>
<p class="programs" translate="no">fancyGreeting()</p>
<p class="indent">Aparecerá el siguiente mensaje de error:</p>
<p class="programs" translate="no"> <span class="red">Traceback (most recent call last):</span><br translate="no"/> <span class="red">File "&lt;pyshell#2&gt;", line 1, in &lt;module&gt;</span><br translate="no"/> <span class="red">fancyGreeting()</span><br translate="no"/><span class="ent">➊</span> <span class="red">TypeError: fancyGreeting() takes exactly 1 argument (0 given)</span></p>
<p class="indent">Se trata de un mensaje de error útil porque la última línea explica lo que está mal en el código <span class="ent">➊.</span> La función <span class="literal">fancyGreeting(</span> ) toma un argumento, pero como no se le dio ningún argumento, eso provocó el error.</p>
<p class="indent">Puedes crear una función que tome varios argumentos. Por ejemplo, el siguiente programa contiene una función que saluda a alguien, espera unos segundos y luego se despide. La función utiliza un argumento para el nombre de la persona y el número de segundos que esperará el programa:</p>
<p class="programs" translate="no"> <span class="orange">import</span> time<br translate="no"/><br translate="no"/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">helloAndGoodbye</span>(personName, secsToWait):<br translate="no"/> <span class="rose">print</span>(<span class="green">"Hello, "</span> + personName)<br translate="no"/>       time.sleep(secsToWait)<br translate="no"/> <span class="rose">print</span>(<span class="green">"Goodbye, "</span> + personName)<br translate="no"/><br translate="no"/><span class="ent">➋</span> helloAndGoodbye(<span class="green">"Mario"</span>, 10)<br translate="no"/>   helloAndGoodbye(<span class="green">"Steve"</span>, 23)</p>
<p class="indent">Cada argumento se separa con una coma cuando se define la función <span class="ent">➊.</span> Luego, cuando se llama a las funciones, los argumentos se pasan en el mismo orden en que se definieron <span class="ent">➋.</span></p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTA</span></strong></p>
<p class="notep">Es<em>posible que encuentres los términos</em> argumento <em>y</em> parámetro <em>utilizados casi indistintamente. Los parámetros de una función definen los tipos de argumentos que acepta o requiere, y los argumentos son los valores que pasas a la función cuando la llamas. Para simplificar,</em> <em>en este</em> libro <em>sólo utilizaremos el término</em> argumento <em>.</em></p>
</div>
<h4 class="h4a" id="ch08lev2sec03"><strong>Misión 41: Construir un bosque</strong></h4>
<p class="noindent">Tu misión es crear un bosque de árboles en Minecraft. Como un bosque no es más que un montón de árboles, crearemos el bosque creando una función que construya un árbol y luego llamaremos a esa función muchas veces para crear un bosque.</p>
<p class="indent"><span epub:type="pagebreak" id="page_153"></span>El listado<a href="ch08.xhtml#ch8ex1">8-1</a> es el código básico que utilizarás.</p>
<p class="sidenote" translate="no"><span class="blue"><em>forest.py</em></span></p>
<p class="programs" translate="no"> <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>   mc = Minecraft.create()<br translate="no"/><br translate="no"/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">growTree</span>(x, y, z):<br translate="no"/> <span class="red"># Creates a tree at the coordinates given</span><br translate="no"/> <span class="red"># Write your code to make a tree here</span><br translate="no"/><br translate="no"/>   pos = mc.player.getTilePos()<br translate="no"/>   x = pos.x<br translate="no"/>   y = pos.y<br translate="no"/>   z = pos.z<br translate="no"/><br translate="no"/><span class="ent">➋</span> growTree(x + 1, y, z)</p>
<p class="examplet"><a id="ch8ex1"></a><em>Listado 8-1: Estructura de un programa que utiliza funciones para crear un bosque de árboles</em></p>
<p class="indent">La función <span class="literal">growTree()</span> <span class="ent">➊</span> creada en este código toma argumentos para las coordenadas donde se construirá el árbol. Tu tarea consiste en escribir código en el cuerpo de la función que cree un árbol en las coordenadas dadas. Para ello utilizarás las funciones <span class="literal">setBlock()</span> y <span class="literal">setBlocks()</span>.</p>
<p class="indent">Copia <a href="ch08.xhtml#ch8ex1">el Listado 8-1</a> en un nuevo archivo en IDLE y guárdalo como <em>bosque.py</em> en una nueva carpeta llamada <em>funciones</em>.</p>
<p class="indent">Cuando hayas creado algo que se parezca a un árbol y aparezca en pantalla, prueba a escribir más llamadas a la función utilizando argumentos distintos para que los árboles aparezcan en lugares diferentes. La primera ya la has hecho <span class="ent">➋.</span> Intenta crear al menos nueve árboles delante del jugador cada vez que ejecutes tu programa. <a href="ch08.xhtml#ch8fig1">La Figura 8-1</a> muestra los árboles que creó mi programa.</p>
<div class="image"><img alt="image" src="../images/f08-01.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig1"></a><em>Figura 8-1: Acabo de crear una hermosa hilera de árboles.</em></p>
<div class="sidebar">
<p class="sidebart" id="ch08sb01"><span epub:type="pagebreak" id="page_154"></span><strong>OBJETIVO EXTRA: BOSQUE ALEATORIO</strong></p>
<p class="noindent">Utiliza la función <span class="literal">randint()</span> del módulo <span class="literal">random</span> para aleatorizar la distancia entre los árboles del bosque.</p>
</div>
<h4 class="h4" id="ch08lev2sec04"><strong><span class="blue1">Refactorizar un programa</span></strong></h4>
<p class="noindent">A menudo escribirás un programa que utiliza varias veces el mismo bloque de código. Hacer cambios en el programa se volverá tedioso cuando quieras cambiar el mismo código en distintos lugares. Puede que hayas hecho esto en programas que has escrito en el pasado, pero hay una forma mucho mejor.</p>
<p class="indent">Puedes reestructurar tus programas para que utilicen funciones. Para ello, traslada el código que se repite varias veces a una única función que luego podrás utilizar tantas veces como quieras en el resto del código. Como sólo tendrás que hacer cambios en un lugar en lugar de en varios, ahorrarás espacio y el programa será más fácil de mantener. El proceso de reestructurar tu código de este modo se denomina <em>refactorización</em>.</p>
<p class="indent">Por ejemplo, el siguiente código pregunta su nombre a tres personas y luego imprime un saludo a cada una de ellas:</p>
<p class="programs" translate="no">name1 = <span class="rose">input</span>(<span class="green">"Hello, what is your name?"</span>)<br translate="no"/><span class="rose">print</span>(<span class="green">"Pleased to meet you, "</span> + name1)<br translate="no"/>name2 = <span class="rose">input</span>(<span class="green">"Hello, what is your name?"</span>)<br translate="no"/><span class="rose">print</span>(<span class="green">"Pleased to meet you, "</span> + name2)<br translate="no"/>name3 = <span class="rose">input</span>(<span class="green">"Hello, what is your name?"</span>)<br translate="no"/><span class="rose">print</span>(<span class="green">"Pleased to meet you, "</span> + name3)</p>
<p class="indent">El código repite tres veces las mismas dos afirmaciones. ¿Y si quisieras cambiar la pregunta o el saludo? No hay mucho problema en cambiar el código para 3 personas, pero ¿y si escribieras código para 100 personas?</p>
<p class="indent">La alternativa es escribir el código como una función y llamarla tres veces. Aquí tienes el código después de refactorizarlo:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">helloFriend</span>():<br translate="no"/>    name = <span class="rose">input</span>(<span class="green">"Hello, what is your name?"</span>)<br translate="no"/> <span class="rose">print</span>(<span class="green">"Pleased to meet you, "</span> + name)<br translate="no"/><br translate="no"/>helloFriend()<br translate="no"/>helloFriend()<br translate="no"/>helloFriend()</p>
<p class="indent">Ahora, cuando el programa se ejecute, pedirá una entrada y luego emitirá una cadena, y hará ambas tareas tres veces. Aquí tienes la entrada y la salida:</p>
<p class="programs" translate="no"><span class="blue1">Hello, what is your name?</span> Craig<br translate="no"/><span class="blue1">Pleased to meet you, Craig<br translate="no"/>Hello, what is your name?</span> Still Craig<br translate="no"/><span class="blue1">Pleased to meet you, Still Craig<br translate="no"/>Hello, what is your name?</span> Craig again<br translate="no"/><span class="blue1">Pleased to meet you, Craig again</span></p>
<p class="indent"><span epub:type="pagebreak" id="page_155"></span>La segunda versión del código tiene el mismo resultado que la primera, pero como puedes ver, es mucho más fácil de leer y mucho más fácil de cambiar.</p>
<h4 class="h4a" id="ch08lev2sec05"><strong>Misión nº 42: Refactoriza</strong></h4>
<p class="noindent">A veces escribirás un programa para darte cuenta después de que deberías haber utilizado funciones (a mí me pasa a menudo). Refactorizar el código para incluir funciones es una habilidad muy importante.</p>
<p class="indent">En esta misión, practicarás la refactorización de un programa para utilizar una función en lugar de repetir varias veces las mismas sentencias.</p>
<p class="indent"><a href="ch08.xhtml#ch8ex2">El listado 8-2</a> coloca un bloque melón debajo del jugador cada 10 segundos. Reescribiremos el código para utilizar una función. Actualmente, el programa coloca tres bloques utilizando la misma línea de código tres veces. <a href="ch08.xhtml#ch8fig2">La Figura 8-2</a> muestra el resultado del programa.</p>
<p class="sidenote" translate="no"><span class="blue"><em>melonFunction.py</em></span></p>
<p class="programs" translate="no"><span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>mc = Minecraft.create()<br translate="no"/><br translate="no"/><span class="orange">import</span> time<br translate="no"/><br translate="no"/>pos = mc.player.getPos()<br translate="no"/>x = pos.x<br translate="no"/>y = pos.y<br translate="no"/>z = pos.z<br translate="no"/>mc.setBlock(x, y - 1, z, 103)<br translate="no"/>time.sleep(10)<br translate="no"/><br translate="no"/>pos = mc.player.getPos()<br translate="no"/>x = pos.x<br translate="no"/>y = pos.y - 1<br translate="no"/>z = pos.z<br translate="no"/>mc.setBlock(x, y, z, 103)<br translate="no"/>time.sleep(10)<br translate="no"/><br translate="no"/>pos = mc.player.getPos()<br translate="no"/>x = pos.x<br translate="no"/>y = pos.y - 1<br translate="no"/>z = pos.z<br translate="no"/>mc.setBlock(x, y, z, 103)<br translate="no"/>time.sleep(10)</p>
<p class="examplet"><a id="ch8ex2"></a><em>Listado 8-2: Código que necesita refactorización</em></p>
<p class="indent">Este código no es muy bonito, ¿verdad? Se repiten varias líneas, lo que siempre es señal de que el código necesita ser refactorizado con la ayuda de una definición de función.</p>
<div class="note">
<p class="notet"><strong><span class="hints">CONSEJO</span></strong></p>
<p class="notep"><em>Identifica qué partes del código se repiten para hacerte una idea de lo que debe hacer tu función.</em></p>
</div>
<div class="image"><span epub:type="pagebreak" id="page_156"></span><img alt="image" src="../images/f08-02.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig2"></a><em>Figura 8-2: Tres deliciosos melones bajo tierra</em></p>
<p class="indent">Cambia el código para que coloque seis bloques en total llamando a tu función seis veces. Crea un nuevo archivo y guárdalo como <em>funciónmelón.py</em> en la carpeta <em>funciones</em>. Copia <a href="ch08.xhtml#ch8ex2">el Listado 8-2</a> en tu archivo y refactoriza el código para utilizar una función. Llama a la nueva función <span class="literal">hacerMelón()</span>.</p>
<div class="sidebar">
<p class="sidebart" id="ch08sb02"><strong>OBJETIVO EXTRA: BLOQUES BAJO PIE</strong></p>
<p class="noindent">Añade argumentos a tu función <span class="literal">makeMelon</span> () para controlar el tipo de bloque, el tiempo de reposo o la distancia por debajo del jugador.</p>
</div>
<h4 class="h4" id="ch08lev2sec06"><strong><span class="blue1">Comentar con Docstrings</span></strong></h4>
<p class="noindent">Utilizar comentarios en el código Python es una forma de explicar lo que hace el código. Cuando Python ejecuta un programa, ignora todo lo que hay en un comentario, por lo que los comentarios no afectan a cómo se ejecuta el código. El objetivo principal de los comentarios es explicar lo que se supone que debe hacer tu código a otras personas que puedan verlo o utilizarlo. Los comentarios también son recordatorios útiles para ti mismo en el futuro.</p>
<p class="indent">Como se supone que las funciones son reutilizables, tiene sentido explicar su finalidad. Para escribir las explicaciones de nuestras funciones, utilizaremos explicaciones largas llamadas <em>docstrings</em>. Una docstring es un comentario de varias líneas que colocas al principio de una función para explicar su uso.</p>
<p class="indent">La función <span class="literal">duplicarPalabra(</span> ) del siguiente ejemplo tiene una docstring que explica su tarea:</p>
<p class="programs" translate="no"> <span class="orange">def</span> <span class="blue1">duplicateString</span>(stringToDbl):<br translate="no"/><span class="ent">➊</span> <span class="green">""" Prints a string twice on the same line.</span><br translate="no"/> <span class="green">stringToDbl argument should be a string """</span><br translate="no"/> <span class="rose">print</span>(stringToDbl * 2)</p>
<p class="indent"><span epub:type="pagebreak" id="page_157"></span>La docstring debe estar en la primera línea de una función <span class="ent">➊.</span> La docstring comienza y termina con un conjunto de tres comillas (<span class="literal">"""</span>) y puede escribirse en tantas líneas como sea necesario.</p>
<h4 class="h4" id="ch08lev2sec07"><strong><span class="blue1">Saltos de línea en los argumentos</span></strong></h4>
<p class="noindent">Para facilitar la lectura de largas listas de argumentos a los programadores, Python te permite colocar los argumentos a lo largo de varias líneas. Por ejemplo, la llamada a la función de este programa tiene sus argumentos divididos en varias líneas para aumentar la legibilidad:</p>
<p class="programs" translate="no"><span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>mc = Minecraft.create()<br translate="no"/><br translate="no"/>pos = mc.player.getPos()<br translate="no"/>width = 10<br translate="no"/>height = 12<br translate="no"/>length = 13<br translate="no"/>block = 103<br translate="no"/>mc.setBlocks(pos.x, pos.y, pos.z,<br translate="no"/>             pos.x + width, pos.y + height, pos.z + length, block)</p>
<p class="indent">Los saltos de línea en los argumentos son especialmente útiles cuando quieres utilizar operadores matemáticos en los argumentos, cuando utilizas nombres largos de variables como argumentos o cuando tienes que proporcionar varios argumentos a una función.</p>
<h4 class="h4" id="ch08lev2sec08"><strong><span class="blue1">Valores de retorno de las funciones</span></strong></h4>
<p class="noindent">Hay dos tipos de funciones: las que devuelven un valor y las que no. Hasta ahora, has creado funciones que no devuelven ningún valor. Veamos las que sí devuelven un valor.</p>
<p class="indent">Devolver un valor desde una función es muy útil, porque permite que una función trabaje con datos y luego devuelva un valor al cuerpo principal del programa. Por ejemplo, imagina que vendes galletas. Para calcular el precio al que tienes que vender cada galleta para obtener suficientes beneficios, añades dos monedas de oro a la cantidad que pagaste por hacer la galleta y luego multiplicas la suma por 10. Utilizando una función que devuelva un valor, puedes escribir este cálculo y reutilizarlo en Python.</p>
<p class="indent">Cuando crees tus propias funciones, puedes utilizar la palabra clave <span class="literal">return</span> para devolver un valor de la función. Por ejemplo, aquí tienes el código para calcular el precio de venta de una galleta:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">calculateCookiePrice</span>(cost):<br translate="no"/>    price = cost + 2<br translate="no"/>    price = price * 10<br translate="no"/> <span class="orange">return</span> price</p>
<p class="indent"><span epub:type="pagebreak" id="page_158"></span>Para devolver un valor, sólo tienes que escribir <span class="literal">return</span> seguido del valor que quieras, que en este caso es <span class="literal">el precio</span>. Para utilizar una función que devuelve un valor, la llamas en un lugar en el que se esperaría un valor. Por ejemplo, para establecer la variable <span class="literal">precioDeCookie</span>, llama a la función <span class="literal">calcularPrecioDeCookie()</span> e introduce un coste, como <span class="literal">6</span>:</p>
<p class="programs" translate="no">priceOfCookie = calculateCookiePrice(6)  <span class="red"># Value will be 80</span></p>
<p class="indent">Puedes utilizar funciones que devuelvan valores para establecer los valores de las variables, y puedes utilizarlas en cualquier lugar en el que se espere que pongas un valor, incluso como argumento de otra función.</p>
<p class="indent">Las funciones que no devuelven un valor no pueden utilizarse para establecer los valores de las variables. Veamos rápidamente la diferencia.</p>
<p class="indent">Como la siguiente función devuelve un valor, se puede utilizar en cualquier lugar donde se pueda utilizar un valor, como para fijar una variable o incluso como argumento en otra llamada a una función:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">numberOfChickens</span>():<br translate="no"/> <span class="orange">return</span> 5<br translate="no"/><br translate="no"/>coop = numberOfChickens()<br translate="no"/><span class="rose">print</span>(numberOfChickens())</p>
<p class="indent">Ejecuta este código para ver su resultado. Puedes tratar el resultado de la función como un valor e incluso hacer operaciones matemáticas con él. Aquí añado 4 al valor devuelto y lo almaceno en una variable llamada <span class="literal">extraGallinas</span>:</p>
<p class="programs" translate="no">extraChickens = 4 + numberOfChickens()  <span class="red"># Value of 9</span></p>
<p class="indent">Sin embargo, la siguiente función no tiene declaración de <span class="literal">retorno</span>, lo que significa que no puedes utilizarla en lugar de un valor. Lo único que puedes hacer es llamar a la función:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">chickenNoise</span>():<br translate="no"/> <span class="rose">print</span>(<span class="green">"Cluck"</span>)<br translate="no"/><br translate="no"/>chickenNoise()</p>
<p class="indent">Escribiendo este código en el editor de texto y ejecutándolo se imprime <span class="literal">"Cluck"</span>, aunque no se puede utilizar en otras sentencias porque no devuelve un valor al programa. Por ejemplo, podría intentar concatenar la función con una cadena, así:</p>
<p class="programs" translate="no">multipleNoises = chickenNoise() + <span class="green">", Bork"</span></p>
<p class="indent">Si ejecutara este programa, obtendría el siguiente mensaje de error:</p>
<p class="programs" translate="no"><span class="red">Traceback (most recent call last):</span><br translate="no"/> <span class="red">File "&lt;pyshell#3&gt;", line 1, in &lt;module&gt;</span><br translate="no"/> <span class="red">multipleNoises = chickenNoise + ", Bork"</span><br translate="no"/><span class="red">TypeError: unsupported operand type(s) for +: 'function' and 'str'</span></p>
<p class="indent"><span epub:type="pagebreak" id="page_159"></span>Este error significa que no puedes combinar esta función con una cadena, porque la función no devuelve un valor.</p>
<p class="indent">Sin embargo, si cambio el código para que devuelva un valor en lugar de limitarse a imprimirlo</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">chickenNoise</span>():<br translate="no"/>    return <span class="green">"Cluck"</span><br translate="no"/><br translate="no"/>multipleNoises = chickenNoise() + <span class="green">", Bork"</span><br translate="no"/><span class="rose">print</span>(multipleNoises)</p>
<p class="indent">el archivo se ejecutaría y mostraría la siguiente salida:</p>
<p class="programs" translate="no"><span class="blue1">Cluck, Bork</span></p>
<p class="indent">Ten en cuenta esta diferencia. Recuerda incluir una sentencia <span class="literal">return</span> cuando la necesites y excluirla cuando tu función no necesite devolver un valor. Cuanto más experiencia adquieras con las funciones, más fácil te resultará decidir si quieres que tu función devuelva un valor.</p>
<h4 class="h4a" id="ch08lev2sec09"><strong>Misión nº 43: Recordatorio de ID de bloque</strong></h4>
<p class="noindent">Como Minecraft tiene tantos bloques, es difícil recordar todos los ID de bloque. Yo siempre recuerdo los valores de melón (103) y aire (0), pero olvido otros, ¡así que sigo teniendo que construir casas de melones!</p>
<p class="indent">Para que recordar me resulte más fácil, quiero que crees un programa para mí que devuelva los valores de los distintos bloques. Tu programa debe tener muchas funciones que me ayuden a recordar los ID de los bloques. El nombre de cada función debe ser el mismo que el del bloque cuyo valor devuelve. Por ejemplo, <a href="ch08.xhtml#ch8ex3">el Listado 8-3</a> tiene una función llamada <span class="literal">melón()</span> que devuelve el valor del bloque melón (103).</p>
<p class="sidenote" translate="no"><span class="blue"><em>blockIds.py</em></span></p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">melon</span>():<br translate="no"/> <span class="green">""" Returns the value of the melon block """</span><br translate="no"/> <span class="orange">return</span> 103</p>
<p class="examplet"><a id="ch8ex3"></a><em>Listado 8-3: Inicio del programa que me ayudará a recordar los ID de los bloques</em></p>
<p class="indentb">Crea un nuevo archivo en IDLE y guárdalo como <em>blockIds.py</em> en la carpeta <em>functions</em>. Copia <a href="ch08.xhtml#ch8ex3">el Listado 8-3</a> en el archivo y añádele funciones que devuelvan los valores de los siguientes bloques (consulta "<a href="app03.xhtml#app03">Hoja de trucos</a>de ID de bloque" en la <a href="app03.xhtml#page_299">página 299</a>):</p>
<p class="bull">- Agua</p>
<p class="bull">- Lana</p>
<p class="bull">- Lava</p>
<p class="bull">- TNT</p>
<p class="bull">- Flor</p>
<p class="bull">- Bloque de diamante</p>
<p class="indentt"><span epub:type="pagebreak" id="page_160"></span>Cuando hayas añadido tus funciones, pruébalas llamándolas para crear bloques. Como tus nuevas funciones devuelven el valor de un bloque, puedes utilizarlas para establecer el valor de una variable que pasarás a la función <span class="literal">setBlock()</span>. El siguiente código te ayudará a empezar:</p>
<p class="programs" translate="no"><span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>mc = Minecraft.create()<br translate="no"/><br translate="no"/><span class="red"># Functions go here</span><br translate="no"/><br translate="no"/>block = melon()<br translate="no"/>pos = mc.player.getTilePos()<br translate="no"/>mc.setBlock(pos.x, pos.y, pos.z, block)</p>
<p class="indent"><a href="ch08.xhtml#ch8fig3">La Figura 8-3</a> muestra el resultado del programa completado con una prueba de la función <span class="literal">melón()</span>. Observa que la colocación de cualquier bloque está codificada en este programa; siempre colocará un bloque en su ubicación actual.</p>
<div class="image"><img alt="image" src="../images/f08-03.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig3"></a><em>Figura 8-3: Ahora no tengo que recordar los tipos de bloque, todo gracias a esta práctica función.</em></p>
<div class="note">
<p class="notet"><strong><span class="hints">CONSEJO</span></strong></p>
<p class="notep"><em>Para colocar un bloque diamante, TNT o cualquier otro tipo de bloque, primero tendrás que definir la función que devuelve el valor del bloque que quieres. Luego tendrás que llamar a esa función en tu código, igual que yo he llamado a la</em> <em>función</em> <span class="literal"><span class="codeitalic">melón()</span></span> <em>en este ejemplo.</em></p>
</div>
<div class="sidebar">
<p class="sidebart" id="ch08sb03"><strong>OBJETIVO EXTRA: MÁS BLOQUES</strong></p>
<p class="noindent">Añade funciones adicionales para cualquier otro tipo de bloque que desees.</p>
</div>
<h3 class="h3" id="ch08lev1sec02"><span epub:type="pagebreak" id="page_161"></span><strong><span class="blue1">Uso de sentencias if y bucles while en funciones</span></strong></h3>
<p class="noindent">En los <a href="ch06.xhtml#ch06">Capítulos 6</a> y <a href="ch07.xhtml#ch07">7</a>, aprendiste a poner sentencias <span class="literal">if</span> dentro de otras sentencias <span class="literal">if</span> y bucles <span class="literal">while</span> dentro de otros bucles <span class="literal">while</span>. Aprendiste que incluso puedes poner sentencias <span class="literal">if</span> dentro de bucles <span class="literal">while</span> y viceversa. En esta sección aprenderás a colocar sentencias <span class="literal">if</span> y bucles dentro de funciones. Esto hace que tus funciones sean muy flexibles, porque puedes utilizarlas para tomar decisiones y repetir código.</p>
<h4 class="h4" id="ch08lev2sec10"><strong><span class="blue1">Sentencias if</span></strong></h4>
<p class="noindent">Cuando escribes una sentencia <span class="literal">if</span> dentro de una función, la sintaxis es idéntica a la de una sentencia <span class="literal">if</span> normal. Sólo tienes que acordarte de sangrar la sentencia <span class="literal">if</span> cuatro espacios más al principio de cada línea para que Python sepa que forma parte de la función.</p>
<p class="indent">El siguiente código toma un número escrito como una cadena y devuelve el número como un entero. Por ejemplo, el argumento <span class="literal">"cuatro</span> " devuelve el valor <span class="literal">4</span>:</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">wordToNumber</span>(numToConvert):<br translate="no"/> <span class="green">""" Converts a number written as a word to an integer """</span><br translate="no"/> <span class="orange">if</span> numToConvert == <span class="green">"one"</span>:<br translate="no"/>        numAsInt = 1<br translate="no"/> <span class="orange">elif</span> numToConvert == <span class="green">"two"</span>:<br translate="no"/>        numAsInt = 2<br translate="no"/> <span class="orange">elif</span> numToConvert == <span class="green">"three"</span>:<br translate="no"/>        numAsInt = 3<br translate="no"/> <span class="orange">elif</span> numToConvert == <span class="green">"four"</span>:<br translate="no"/>        numAsInt = 4<br translate="no"/> <span class="orange">elif</span> numToConver == <span class="green">"five"</span>:<br translate="no"/>        numAsInt = 5<br translate="no"/><br translate="no"/> <span class="orange">return</span> numAsInt</p>
<p class="indent">Veamos otro ejemplo. La siguiente función comprueba si has conocido antes a una persona y utiliza un saludo adecuado en función del resultado:</p>
<p class="programs" translate="no"><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">chooseGreeting</span>(metBefore):<br translate="no"/> <span class="green">""" Chooses a greeting depending on whether you've met someone before.</span><br translate="no"/> <span class="green">metBefore argument should be a Boolean value """</span><br translate="no"/> <span class="orange">if</span> metBefore:<br translate="no"/><span class="ent">➋</span> <span class="rose">print</span>(<span class="green">"Nice to see you again"</span>)<br translate="no"/> <span class="orange">else</span>:<br translate="no"/><span class="ent">➌</span> <span class="rose">print</span>(<span class="green">"Nice to meet you"</span>)<br translate="no"/><br translate="no"/>   chooseGreeting(<span class="orange">True</span>)<br translate="no"/>   chooseGreeting(<span class="orange">False</span>)</p>
<p class="indent"><span epub:type="pagebreak" id="page_162"></span>La función <span class="literal">elegirSaludo(</span> ) toma un argumento booleano, llamado <span class="literal">metAntes</span> <span class="ent">➊.</span> La sentencia <span class="literal">if</span> que hay dentro de la función imprime una salida basada en el valor del argumento. Si el valor es <span class="literal">True</span>, la salida será "Encantado de <span class="literal"> volver a verte"</span> <span class="ent">➋,</span> y si es <span class="literal">False</span> <span class="ent">➌,</span> la salida será <span class="literal">"Encantado de conocerte"</span>.</p>
<h4 class="h4a" id="ch08lev2sec11"><strong>Misión nº 44: Ayudante del color de la lana</strong></h4>
<p class="noindent">Has utilizado los métodos <span class="literal">setBlock()</span> y <span class="literal">setBlocks()</span> con argumentos para establecer las coordenadas y el tipo de bloque, pero estos métodos también tienen un argumento extra opcional que establecerá el <em>estado</em> del bloque.</p>
<p class="indent">Cada bloque en Minecraft tiene 16 estados, de 0 a 15. La lana, por ejemplo, tiene un color diferente para cada estado. El TNT (ID del bloque 46) no explotará cuando lo aplastes en su estado por defecto (estado 0), pero es explosivo cuando lo aplastas en el estado 1 del bloque. Aunque cada bloque tiene 16 estados, no todos tienen comportamientos diferentes.</p>
<p class="indent">Para establecer el estado de un bloque, proporciona a la función <span class="literal">setblock()</span> o <span class="literal">setblocks()</span> un argumento extra. El siguiente código crea un bloque rosa de lana:</p>
<p class="programs" translate="no"><span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>mc = Minecraft.create()<br translate="no"/><br translate="no"/>block = 35<br translate="no"/>state = 6<br translate="no"/><span class="red"># Creates a single block of pink wool</span><br translate="no"/>mc.setBlock(10, 3, -4, block, state)<br translate="no"/><br translate="no"/><span class="red"># Creates a cuboid of pink wool</span><br translate="no"/>mc.setBlocks(11, 3, -4, 20, 6, -8, block, state)</p>
<p class="indent">La lana (ID de bloque 35) tiene muchos usos en Minecraft debido a sus diferentes colores, pero es difícil recordar los diferentes estados de los bloques. Afortunadamente, no necesitas memorizar los diferentes estados de los bloques cuando puedes utilizar un programa que te lo recuerde.</p>
<p class="indent">Hagamos un programa que contenga los estados del bloque lana. El programa contendrá una función con un argumento que toma el color que quieras escrito como una cadena. A continuación, la función devuelve el estado del bloque para el color de la lana como un número entero. La función contendrá la mayor parte del código del programa. Sin embargo, añadirás un par de líneas de código para recibir la entrada de un usuario y colocar el bloque en el juego, y utilizarás tu nueva y elegante función para establecer el color.</p>
<p class="indent">En primer lugar, tendrás que averiguar los estados de bloque para los distintos colores de lana. Puedes encontrarlos en la "<a href="app03.xhtml#app03">Hoja de trucos de ID de bloque</a>" en <a href="app03.xhtml#page_299">la página 299</a>. Aquí tienes algo de código para empezar (el rosa es el estado de bloque 6):</p>
<p class="sidenote" translate="no"><span class="blue"><em>woolColors.py</em></span></p>
<p class="programs" translate="no"> <span class="orange">def</span> <span class="blue1">getWoolState</span>(color):<br translate="no"/> <span class="green">""" Takes a color as a string and returns the wool block state for</span><br translate="no"/> <span class="green">that color """</span><br translate="no"/><span class="ent">➊</span> <span class="orange">if</span> color == <span class="green">"pink"</span>:<br translate="no"/>           blockState = 6<br translate="no"/> <span class="orange">elif</span> <span class="red"># Add elif statements for the other colors</span><br translate="no"/> <span class="red"># Return the blockState here</span><br translate="no"/><br translate="no"/><span class="ent">➋</span> colorString = <span class="rose">input</span>(<span class="green">"Enter a block color: "</span>)<br translate="no"/>   state = getWoolState(colorString)<br translate="no"/><br translate="no"/><span class="ent">➌</span> pos = mc.player.getTilePos()<br translate="no"/>   mc.setBlock(pos.x, pos,y, pos.z, 35, state)</p>
<p class="indent"><span epub:type="pagebreak" id="page_163"></span>De momento, el programa sólo tiene el principio de la función <span class="literal">getWoolState()</span>. Sólo tiene una sentencia <span class="literal">if</span> para el color rosa <span class="ent">➊.</span> También se incluye código al final del programa para tomar la entrada del usuario para el color del bloque <span class="ent">➋</span> y código para colocar el bloque de lana en la posición del jugador <span class="ent">➌.</span></p>
<p class="indent">Añade a la función <span class="literal">getWoolState(</span> ) declaraciones <span class="literal">elif</span> para otros colores de lana y sus correspondientes estados de bloque. El programa debe tomar un argumento para el color del bloque y devolver el valor entero del estado del bloque. Por ejemplo, si proporcionas el argumento <span class="literal">"rosa</span> ", devolverá el valor 6. También tendrás que añadir una sentencia <span class="literal">return</span> al programa. Utiliza los comentarios como guía.</p>
<p class="indent">Guarda el archivo como <em>lanaColores.py</em> en la carpeta de <em>funciones</em>.</p>
<p class="indent">Si quieres que el programa sea más fácil de usar, puedes enviar un mensaje al chat si el argumento no es un color válido. <a href="ch08.xhtml#ch8fig4">La Figura 8-4</a> muestra la entrada en el intérprete de comandos Python y el bloque de lana colocado en el juego.</p>
<div class="image"><img alt="image" src="../images/f08-04.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig4"></a><em>Figura 8-4: Ahora puedo crear un bloque de lana de cualquier color introduciendo el nombre del color que quiero.</em></p>
<h4 class="h4" id="ch08lev2sec12"><strong><span class="blue1">Bucles while</span></strong></h4>
<p class="noindent">Al igual que las sentencias <span class="literal">if</span>, los bucles se pueden escribir dentro de funciones. La sintaxis de un bucle dentro de una función es la misma que la de un bucle normal. Sólo tienes que recordar que el bucle debe tener una sangría adicional de cuatro espacios en cada línea para indicar que pertenece a la función.</p>
<p class="indent"><span epub:type="pagebreak" id="page_164"></span>En el siguiente ejemplo, el bucle <span class="literal">while</span> dentro de la función imprimirá el argumento <span class="literal">toPrint</span>. El número de veces que se repite el bucle viene determinado por el argumento <span class="literal">repeticiones</span>.</p>
<p class="programs" translate="no"><span class="orange">def</span> <span class="blue1">printMultiple</span>(toPrint, repeats):<br translate="no"/> <span class="green">""" Prints a string a number of times determined by the repeats variable """</span><br translate="no"/>    count = 0<br translate="no"/> <span class="orange">while</span> count &lt; repeats:<br translate="no"/> <span class="rose">print</span>(toPrint)<br translate="no"/>        count += 1</p>
<p class="indent">También puedes utilizar sentencias <span class="literal">return</span> y bucles <span class="literal">while</span> en la misma función. En la mayoría de los casos, querrás que la sentencia de <span class="literal">retorno</span> esté fuera del bucle. (Si utilizas la sentencia <span class="literal">return</span> dentro de un bucle, romperá el bucle y terminará la función). Veamos un ejemplo:</p>
<p class="programs" translate="no"> <span class="orange">def</span> <span class="blue1">doubleUntilHundred</span>(numberToDbl):<br translate="no"/> <span class="green">""" Doubles a number until it is greater than 100. Returns the number of</span><br translate="no"/> <span class="green">times the number was doubled """</span><br translate="no"/>       count = 0<br translate="no"/> <span class="orange">while</span> numToDbl &lt; 100:<br translate="no"/>           numberToDbl = numberToDbl * 2<br translate="no"/>           count += 1<br translate="no"/><span class="ent">➊</span> <span class="orange">return</span> count<br translate="no"/><br translate="no"/> <span class="rose">print</span>(doubleUntilHundred(2))</p>
<p class="indent">Este programa duplica un número hasta que es mayor que 100. Luego devuelve el número de veces que se repitió el bucle <span class="ent">➊.</span></p>
<p class="indent">También puedes poner llamadas a funciones dentro de bucles, como hiciste en capítulos anteriores.</p>
<h4 class="h4a" id="ch08lev2sec13"><strong>Misión nº 45: Bloques, por todas partes</strong></h4>
<p class="noindent">Al utilizar bucles dentro de funciones, puedes utilizar un argumento para determinar el número de veces que se repite un bucle. Utilizando la función <span class="literal">setBlock(</span> ), también puedes determinar el tipo de bloque que se colocará dentro del bucle.</p>
<div class="note">
<p class="notet"><strong><span class="warnings">ADVERTENCIA</span></strong></p>
<p class="notep"><em>El programa de esta misión podría ser destructivo, por lo que tal vez quieras probarlo en un mundo nuevo para preservar tus preciadas creaciones.</em></p>
</div>
<p class="indent">En esta misión, crearás una función que coloca bloques aleatoriamente por el mapa. El número de bloques que coloca y el tipo de bloque que coloca vienen determinados por los argumentos de la función.</p>
<p class="indent"><a href="ch08.xhtml#ch8ex4">El listado 8-4</a> genera un melón en un lugar aleatorio del mapa.</p>
<p class="sidenote" translate="no"><span epub:type="pagebreak" id="page_165"></span><span class="blue"><em>blocksEverywhere.py</em></span></p>
<p class="programs" translate="no"> <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>   mc = Minecraft.create()<br translate="no"/> <span class="orange">import</span> random<br translate="no"/><br translate="no"/> <span class="orange">def</span> <span class="blue1">randomBlockLocations</span>(blockType, repeats):<br translate="no"/><span class="ent">➊</span>     count = 0<br translate="no"/><span class="ent">➋</span> <span class="red"># Add the loop here</span><br translate="no"/>       x = random.randint(-127, 127)<br translate="no"/>       z = random.randint(-127, 127)<br translate="no"/><span class="ent">➌</span>     y = mc.getHeight(x, z)<br translate="no"/>       mc.setBlock(x, y, z, blockType)<br translate="no"/>       count += 1</p>
<p class="examplet"><a id="ch8ex4"></a><em>Listado 8-4: Al ser llamada, esta función colocará un bloque aleatoriamente en el juego.</em></p>
<p class="indent">Copia <a href="ch08.xhtml#ch8ex4">el Listado 8-4</a> en un nuevo archivo en IDLE y guárdalo como <em>blocksEverywhere.py</em> en la carpeta <em>functions</em>. En <span class="ent">➋,</span> añade un bucle <span class="literal">while</span> dentro de la función para que el código se repita. La variable <span class="literal">cuenta</span> <span class="ent">➊</span> te facilita saber cuántas veces se ha repetido el bucle. Compara el argumento <span class="literal">repeticiones</span> con la variable <span class="literal">cuenta</span> en la condición del bucle para establecer cuántas veces debe repetirse el bucle. Pon sangría a todas las líneas dentro de la función después de <span class="ent">➋</span> para que también estén dentro del bucle. La función <span class="literal">getHeight(</span> ) se encarga de que el bloque se sitúe por encima del suelo <span class="ent">➌.</span></p>
<p class="indent">Por último, añade tres llamadas a funciones para crear bloques. La primera función debe crear 10 bloques, la segunda debe crear 37 bloques y la tercera debe crear 102 bloques. Elige los tipos de bloque que quieras.</p>
<p class="indent">Guarda el programa y ejecútalo. El programa debería crear bloques aleatoriamente alrededor del mapa. <a href="ch08.xhtml#ch8fig5">La Figura 8-5</a> muestra un ejemplo.</p>
<div class="image"><img alt="image" src="../images/f08-05.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig5"></a><em>Figura 8-5: Puedes ver algunos de los bloques que el programa ha colocado aleatoriamente. He creado un mundo nuevo para demostrar este programa, de modo que no dañe ninguno de mis edificios.</em></p>
<h3 class="h3" id="ch08lev1sec03"><span epub:type="pagebreak" id="page_166"></span><strong><span class="blue1">Variables globales y locales</span></strong></h3>
<p class="noindent">Cuando defines funciones, tienes que enfrentarte a un nuevo reto: el ámbito de una variable. El <em>ámbito</em> de una variable describe cómo puede acceder tu programa a sus datos. La mejor forma de aprender sobre el ámbito es verlo en acción, así que veamos algo de código. Supongamos que utilizas el siguiente código, que aumenta el número de huevos que tienes para una fiesta:</p>
<p class="programs" translate="no"><span class="ent">➊</span> eggs = 12<br translate="no"/><br translate="no"/> <span class="orange">def</span> <span class="blue1">increaseEggs</span>():<br translate="no"/><span class="ent">➋</span>     eggs += 1<br translate="no"/> <span class="rose">print</span>(eggs)<br translate="no"/><br translate="no"/>   increaseEggs()</p>
<p class="indent">Dos variables se llaman <span class="literal">huevos</span>, una fuera de la función <span class="ent">➊</span> y otra dentro de la función <span class="ent">➋.</span> Nada parece terriblemente incorrecto, pero Python lanzará un error. Aquí tienes parte del mensaje de error:</p>
<p class="programs" translate="no"><span class="red">UnboundLocalError: local variable 'eggs' referenced before assignment</span></p>
<p class="indent">El problema es que la variable <span class="literal">huevos</span> está definida fuera de la función, pero cuando intentas añadirla dentro de la función, Python no puede ver la variable. Para Python, la variable dentro de la función es totalmente distinta de la que está fuera de la función, aunque tengan el mismo nombre. Python hace esto a propósito para evitar que las variables dentro de diferentes funciones compartan accidentalmente los mismos nombres y causen errores inesperados.</p>
<p class="indent">En el código Python, tienes dos formas de abordar las variables de un archivo: puedes hacer que una variable <em>sea global</em>, lo que significa que afecta a todo un programa o archivo, o hacer que una variable sea <em>local</em>, lo que significa que sólo puede ser vista por el código de una función o bucle concretos. En otras palabras, puedes utilizar la misma variable dentro y fuera de una función, o puedes hacer dos variables diferentes que afecten a distintas partes del código.</p>
<p class="indent">Una variable <em>global</em> será tratada como la misma variable dentro y fuera de una función. Cualquier cambio en la variable dentro de la función afectará a la variable que se definió fuera de la función y viceversa. Para hacer una variable global, utiliza la palabra clave <span class="literal">global</span> <span class="ent">➊:</span></p>
<p class="programs" translate="no">   eggs = 12<br translate="no"/><br translate="no"/> <span class="orange">def</span> <span class="blue1">increaseEggs</span>():<br translate="no"/><span class="ent">➊</span> <span class="orange">global</span> eggs<br translate="no"/>       eggs += 1<br translate="no"/> <span class="rose">print</span>(eggs)<br translate="no"/><br translate="no"/>increaseEggs()</p>
<p class="indent">En este ejemplo, el valor de <span class="literal">huevos</span> será 13 cuando se imprima.</p>
<p class="indent"><span epub:type="pagebreak" id="page_167"></span>En cambio, puedes tratar la variable como una variable <em>local</em> para producir un efecto diferente. En este caso, las variables dentro y fuera de la función se tratarán como variables diferentes. Los cambios en la variable dentro de la función no afectarán a la variable fuera de la función y viceversa. Así que podrías cambiar el código para que la variable sea una variable local <span class="ent">➊,</span> de esta forma</p>
<p class="programs" translate="no">   eggs = 12<br translate="no"/><br translate="no"/> <span class="orange">def</span> <span class="blue1">increaseEggs</span>():<br translate="no"/><span class="ent">➊</span>     eggs = 0<br translate="no"/>       eggs += 1<br translate="no"/><span class="ent">➋</span> <span class="rose">print</span>(eggs)<br translate="no"/><br translate="no"/>    increaseEggs()<br translate="no"/><span class="ent">➌</span> <span class="rose">print</span>(eggs)</p>
<p class="indent">Cuando se imprima el valor de <span class="literal">huevos</span> en la función <span class="ent">➋,</span> será 1 porque el valor de la variable <span class="literal">huevos</span> fuera de la función no afecta a la variable local dentro de la función. El valor de los <span class="literal">huevos</span> dentro de la función <span class="literal">aumentarHuevos(</span> ) es 1, y la variable global <span class="literal">huevos</span> sigue teniendo el valor 12 <span class="ent">➌.</span></p>
<h4 class="h4a" id="ch08lev2sec14"><strong>Misión 46: Un bloque en movimiento</strong></h4>
<p class="noindent">Hace un tiempo, se me ocurrió que sería genial hacer que un bloque se moviera solo por el mundo de Minecraft. Cada segundo avanzaría. Si chocaba contra una pared, un árbol o algo alto, giraba y se dirigía en otra dirección. Sin embargo, si cayera en un agujero, se quedaría atascado y no podría escapar.</p>
<p class="indent"><a href="ch08.xhtml#ch8ex5">El listado 8-5</a> es el inicio de un programa para crear un bloque mágico que se mueva por sí solo.</p>
<p class="sidenote" translate="no"><span class="blue"><em>movingBlock.py</em></span></p>
<p class="programs" translate="no"> <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br translate="no"/>   mc = Minecraft.create()<br translate="no"/><br translate="no"/> <span class="orange">import</span> time<br translate="no"/><br translate="no"/><br translate="no"/> <span class="orange">def</span> <span class="blue1">calculateMove</span>():<br translate="no"/><br translate="no"/> <span class="green">""" Changes the x and z variables for a block. If the block<br translate="no"/>       in front of the block is less than 2 blocks higher, it will move</span><br translate="no"/> <span class="green">forward; otherwise it will try to move left, then backward,</span><br translate="no"/> <span class="green">then finally right. """</span><br translate="no"/><span class="ent">➊</span> <span class="red"># Create global variables here</span><br translate="no"/><br translate="no"/>       currentHeight = mc.getHeight(x, z) - 1<br translate="no"/><br translate="no"/>       forwardHeight = mc.getHeight(x + 1, z)<br translate="no"/>       rightHeight = mc.getHeight(x, z + 1)<br translate="no"/>       backwardHeight = mc.getHeight(x - 1, z)<br translate="no"/>       leftHeight = mc.getHeight(x, z - 1)<br translate="no"/><br translate="no"/> <span class="orange">if</span> forwardHeight - currentHeight &lt; 3:<br translate="no"/>           x += 1<br translate="no"/> <span class="orange">elif</span> rightHeight - currentHeight &lt; 3:<br translate="no"/>           z += 1<br translate="no"/> <span class="orange">elif</span> leftHeight - currentHeight &lt; 3:<br translate="no"/>           z -= 1<br translate="no"/> <span class="orange">elif</span> backwardHeight - currentHeight &lt; 3:<br translate="no"/>           x -= 1<br translate="no"/><br translate="no"/>       y = mc.getHeight(x, z)<br translate="no"/><br translate="no"/><br translate="no"/>   pos = mc.player.getTilePos()<br translate="no"/>   x = pos.x<br translate="no"/>   z = pos.z<br translate="no"/>   y = mc.getHeight(x, z)<br translate="no"/><br translate="no"/> <span class="orange">while True</span>:<br translate="no"/> <span class="red"># Calculate block movement</span><br translate="no"/>       calculateMove()<br translate="no"/><br translate="no"/> <span class="red"># Place block</span><br translate="no"/>       mc.setBlock(x, y, z, 103)<br translate="no"/><br translate="no"/> <span class="red"># Wait</span><br translate="no"/>       time.sleep(1)<br translate="no"/><br translate="no"/> <span class="red"># Remove the block</span><br translate="no"/>       mc.setBlock(x, y, z, 0)</p>
<p class="examplet"><span epub:type="pagebreak" id="page_168"></span><a id="ch8ex5"></a><em>Listado 8-5: Por desgracia, este código no funcionará hasta que se añadan variables globales.</em></p>
<p class="indent">Pero este código aún no se ejecutará porque las variables de la función <span class="literal">calculateMove()</span> no son globales.</p>
<p class="indent">Tu misión es terminar el código del <a href="ch08.xhtml#ch8ex5">Listado 8-5</a>. Cópialo en IDLE y guárdalo como <em>moverBloque.py</em> en la carpeta de <em>funciones</em>. Añade código al inicio de la función para hacer globales las variables <span class="literal">x</span>, <span class="literal">y</span> y <span class="literal">z</span>. Las definiciones globales deben colocarse en <span class="ent">➊.</span></p>
<p class="indent">Cuando hayas declarado algunas variables globales, ejecuta el programa. Tu bloque debería moverse. <a href="ch08.xhtml#ch8fig6">La Figura 8-6</a> muestra cómo el bloque se acerca a una pared y luego empieza a moverse a su alrededor.</p>
<div class="sidebar">
<p class="sidebart" id="ch08sb04"><strong>OBJETIVO EXTRA: UN BLOQUE MELÓN MÁS INTELIGENTE</strong></p>
<p class="noindent">Cuando ejecutes el programa <em>movingBlock.py</em>, puede que notes que el bloque avanza más por el eje x, lo que a veces hace que se quede atascado en un bucle entre dos bloques. La razón es que el código no tiene en cuenta las direcciones en las que ya se ha movido el bloque y siempre intentará moverse primero a lo largo del eje x. ¿Puedes averiguar cómo almacenar la última dirección en la que se movió el bloque y cambiar la sentencia <span class="literal">if</span> para que se mueva primero en esa dirección?</p>
</div>
<div class="image"><span epub:type="pagebreak" id="page_169"></span><img alt="image" src="../images/f08-06.jpg" translate="no"/></div>
<p class="figcap"><a id="ch8fig6"></a><em>Figura 8-6: Ha sido divertido ver cómo el melón avanzaba y luego intentaba rodear la pared.</em></p>
<h3 class="h3" id="ch08lev1sec04"><strong><span class="blue1">Lo que has aprendido</span></strong></h3>
<p class="noindent">¡Hurra! En este capítulo has aprendido a crear y llamar funciones. Con las sentencias <span class="literal">return</span> puedes hacer que las funciones devuelvan valores, y puedes escribir bucles y sentencias <span class="literal">if</span> dentro de las funciones. En <a href="ch09.xhtml#ch09">el Capítulo 9</a>, aprenderás sobre las listas, que te permiten almacenar varios datos en una sola variable.<span epub:type="pagebreak" id="page_170"></span></p>
</body>
</html>