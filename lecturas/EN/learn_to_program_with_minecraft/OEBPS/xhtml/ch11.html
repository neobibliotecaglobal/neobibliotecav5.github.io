<html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ns="http://www.w3.org/2001/10/synthesis">
<head>
<title>Learn to Program with Minecraft</title>
<link href="../styles/9781593276706.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:40af8c70-d268-482b-9282-0b537fc6ae71" name="Adept.expected.resource"/>
</head>
<body>
<h2 class="h2" id="ch11"><span epub:type="pagebreak" id="page_235"></span><strong><span class="blue1"><span class="big">11</span></span></strong><br/><strong>SAVING AND LOADING BUILDINGS WITH FILES AND MODULES</strong></h2>
<div class="image1"><img alt="image" src="../images/common01.jpg"/></div>
<p class="noindent">Files are a major part of computing. They let you save data for long-term storage and load data for use in your programs. So far, the programs you’ve been working with have stored data only in variables. You’ve either used hard-coded data in your programs or taken data from user input. Although you can do amazing things with this data, you’re limited to single sessions and your own Minecraft world. Once you learn how to store and retrieve data, you can save and load your Minecraft creations into any Minecraft world, even your friends’ games!</p>
<p class="indent">In this chapter, you’ll learn how to get input from files and how to output data to files. You’ll use some built-in functions in Python and learn how to use two Python <em>modules</em>, the <span class="literal">pickle</span> and <span class="literal">shelve</span> modules, to store entire Minecraft creations.</p>
<p class="indent">Modules can extend what it’s possible to accomplish with Python. Using modules, you can draw pictures on the screen or run websites. Modules also provide functions for common tasks so you don’t have to write your own solutions.</p>
<p class="indent"><span epub:type="pagebreak" id="page_236"></span>You’ll also learn about pip, which is a very useful program for installing new modules. You’ll try it out by using the <span class="literal">Flask</span> module to make a simple website that connects to Minecraft and displays the player’s position.</p>
<h3 class="h3" id="ch11lev1sec01"><strong><span class="blue1">Using Files</span></strong></h3>
<p class="noindent">When you work with computers, you work with files all the time. Anytime you write a text document or some Python code and save it, you’re working with files. Text, pictures, videos, and music are all files! Even this book was stored as a text file while I was writing it. Python’s file-handling features are easy to learn and will let you create files, save files, and read information from files to do cool things in Minecraft. Let’s start with the basics and learn how to read and write to a text file in Python.</p>
<h4 class="h4" id="ch11lev2sec01"><strong><span class="blue1">Opening a File</span></strong></h4>
<p class="noindent">Opening a file is the first step when you’re working with files. To open a file in Python, you use the <span class="literal">open()</span> function, which takes two arguments: the file’s location and its permissions. A file’s <em>location</em> is where the file is stored on your computer. You’ll pass this into the <span class="literal">open()</span> function in the form of a string. The file’s <em>permissions</em> control whether or not Python is allowed to read or modify the file.</p>
<p class="indent">To open (or create) a text file named <em>secretFile.txt</em> in Python, you would use the argument <span class="literal">"secretFile.txt"</span>:</p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"w"</span>)</p>
<p class="indent">The second argument, <span class="literal">"w"</span>, is the permissions argument, which specifies what the program is allowed to do with the file. In this case, <span class="literal">w</span> means that the program can write data to the file <em>secretFile.txt</em>.</p>
<p class="indent">When a program calls the <span class="literal">open()</span> function with a filename, Python first checks whether a file already exists with that name. If the file exists, Python will use the contents of that file in the program. If it doesn’t exist, Python will create a new file with that name.</p>
<p class="indent">If you don’t specify a <em>directory</em> with your filename (a folder and a directory are the same thing), Python will look for the file in the directory where the program is located. If the file is stored in a different directory, you must specify that in the argument. For example, if <em>secretFile.txt</em> was in the <em>secrets</em> directory, the first argument would be <span class="literal">"/secrets/secretFile.txt"</span>:</p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"/secrets/secretFile.txt"</span>, <span class="green">"w"</span>)</p>
<p class="indent">If you provide a directory in the argument and the directory doesn’t exist, or if the file doesn’t exist, you’ll get an error message.</p>
<p class="indentb">There are four options for the permissions argument:</p>
<p class="hanging"><span class="literal"><span class="codestrong">w</span></span> This means <em>write only</em>. Write-only permissions let the program write new data to the file and overwrite content that is already in the file, <span epub:type="pagebreak" id="page_237"></span>but the program cannot read the contents of the file. If a file doesn’t exist with the name that you provide as the first argument, the program will create a new one.</p>
<p class="hanging"><span class="literal"><span class="codestrong">r</span></span> This means <em>read only</em>. Read-only permissions let the program read the contents of the file, but the program is not allowed to modify the file’s contents. This permission cannot be used to create a new file.</p>
<p class="hanging"><span class="literal"><span class="codestrong">r+</span></span> This means <em>read and write</em>. Read-and-write permissions let the program read and change the contents of the file. The program can also write over any content that is already in the file. However, if the file doesn’t exist, a new one will not be created; instead, you’ll get an error.</p>
<p class="hanging"><span class="literal"><span class="codestrong">a</span></span> This stands for <em>append</em>. Append permissions let the program write new data only to the end of the file, leaving the other contents of the file intact. The program cannot read the contents of the file either. This permission can be used to create a new file.</p>
<p class="indentt">There are different circumstances in which you’d use each kind of permission. Let’s say you write some directions to an awesome diamond mine that you found, and you want to load the directions into Minecraft without accidentally changing them. In that case, you’d want to use the read-only permission to make sure nothing in the file changes. Alternatively, if you want someone to be able to add data to a file but you don’t want them to see the other data stored in the file, you would use the append permission. For instance, you could use append if you want to let your friends add notes to a shared travel log without letting them peak inside and read about all your secret treasure!</p>
<p class="indent">Next, you’ll learn how to write data to an open file, and you’ll learn how to close that file to use that data later.</p>
<h4 class="h4" id="ch11lev2sec02"><strong><span class="blue1">Writing to and Saving a File</span></strong></h4>
<p class="noindent">The <span class="literal">write()</span> function writes data to a file that the program has opened. This is the bread and butter of working with files because it lets you save all kinds of data. You provide the data you want written to the file as an argument to the <span class="literal">write()</span> function.</p>
<p class="indent">For example, let’s open a file and write a simple string to it:</p>
<p class="programs">   secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"w"</span>)<br/>   secretFile.write(<span class="green">"This is a secret file. Shhh! Don't tell anyone."</span>)<br/><span class="ent">➊</span> secretFile.close()</p>
<p class="indent">First, you must open the file using the <span class="literal">open()</span> function. Next, use dot notation to call the <span class="literal">write()</span> function to write a string to <em>secretFile.txt</em>. Then, you need to call the <span class="literal">close()</span> function <span class="ent">➊</span>, which saves and closes the file. It’s important to remember to include the <span class="literal">close()</span> function; otherwise, the data will not be stored in the file.</p>
<p class="indent">Run the program and then open <em>secretFile.txt</em> in a text editor to see if your secret message was saved. Try changing the string to write something <span epub:type="pagebreak" id="page_238"></span>different to the file and run the program again. What happens? The old message should have been replaced with the new message! Try changing the message again, but instead of passing <span class="literal">"w"</span> pass in <span class="literal">"a"</span> instead. Now what happens? Pretty cool, huh?</p>
<h4 class="h4" id="ch11lev2sec03"><strong><span class="blue1">Reading a File</span></strong></h4>
<p class="noindent">The <span class="literal">read()</span> function reads the entire contents of a file that a program has opened. You may want to use the data in your program, modify the data and then send it back to the file, or output the data to make it easy to look at. Whatever the reason, you’ll use the <span class="literal">read()</span> function to read files.</p>
<p class="indent">To read a file, you must first open it and then remember to close it when you’re finished. It’s important to learn this habit when you’re working with files in your programs to avoid errors!</p>
<p class="indent">Let’s read a file and then output its contents so we can see what it says. This program, <em>showSecretFile.py</em>, outputs the contents of a file using the <span class="literal">read()</span> and <span class="literal">print()</span> functions:</p>
<p class="sidenote"><span class="blue"><em>showSecretFile.py</em></span></p>
<p class="programs">   secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"r"</span>)<br/><br/><span class="ent">➊</span> <span class="rose">print</span>(secretFile.read())<br/>   secretFile.close()</p>
<p class="indent">First, we open the file, and we pass in <span class="literal">"r"</span> as the permission argument so our program can read from the file. You could also pass in <span class="literal">"r+"</span>, but in this case we’re not writing to the file, so <span class="literal">"r"</span> is best. To print out the contents of <em>secretFile.txt</em>, we pass <span class="literal">secretFile.read()</span> to a <span class="literal">print</span> statement. Finally, even though we haven’t written any data to the file, it’s still a good idea to close it with the <span class="literal">close()</span> function.</p>
<p class="indent">Run the program to see what happens. The contents of <em>secretFile.txt</em> should be printed to the screen. Now you can read the file without having to open it in a text editor like you normally would!</p>
<h4 class="h4" id="ch11lev2sec04"><strong><span class="blue1">Reading a Line of a File</span></strong></h4>
<p class="noindent">Let’s say you have a long text document and you want to look at only part of it. This is where the <span class="literal">readline()</span> function comes in handy. Unlike the <span class="literal">read()</span> function, which gets the entire contents of the file, the <span class="literal">readline()</span> function gets a single line of the file at a time.</p>
<p class="indent">To try the <span class="literal">readline()</span> function, first add a bunch of text to <em>secretFile.txt</em>. You can do this either by using a text editor or by using your fancy new Python abilities to write a bunch of information to it! If you use Python to write to your file, add <span class="literal">\n</span> to your strings whenever you want a new line. For example, if you write <span class="literal">"Cool\nDance\nParty"</span> to a file, Python places <span class="literal">"Cool"</span> on one line, <span class="literal">"Dance"</span> on the next, and <span class="literal">"Party"</span> on the last line, like so:</p>
<p class="programs"><span class="blue1">Cool</span><br/><span class="blue1">Dance</span><br/><span class="blue1">Party</span></p>
<p class="indent"><span epub:type="pagebreak" id="page_239"></span>After you’ve added text to <em>secretFile.txt</em>, write this code into a Python file and save the file as <em>showSecretLines.py</em> in a new folder called <em>files</em>:</p>
<p class="sidenote"><span class="blue"><em>showSecretLines.py</em></span></p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"r"</span>)<br/><br/><span class="rose">print</span>(secretFile.readline())<br/><span class="rose">print</span>(secretFile.readline())<br/><span class="rose">print</span>(secretFile.readline())<br/><br/>secretFile.close()</p>
<p class="indent">Once again, you must open <em>secretFile.txt</em> before you can read from it using the <span class="literal">readline()</span> function. Because you want your <em>showSecretLines.py</em> program to read data from the file, you must pass in <span class="literal">r</span> (or <span class="literal">r+</span>) again. Next, include three <span class="literal">print</span> statements to print the first three lines of <em>secretFile.txt</em>. Finally, close the file again using <span class="literal">close()</span>.</p>
<p class="indent">The <span class="literal">readline()</span> function starts with the first line of your file. Each time the <span class="literal">readline()</span> function is used, it reads the next line automatically. This function is very handy for printing a couple of lines from the beginnings of text files.</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>The</em> <span class="literal"><span class="codeitalic">readline()</span></span> <em>function converts the file to a list of strings, where each item in the list represents a single line. If you want to print a line from the middle of a text document, you could write a loop to find and print a particular string in the list!</em></p>
</div>
<h4 class="h4a" id="ch11lev2sec05"><strong>Mission #64: To-Do List</strong></h4>
<p class="noindent">Sometimes you might not have much spare time to play Minecraft. You might build complex structures across several days in short sessions. As you add programs to open doors or teleport the player somewhere, your builds will become more complex and might take longer to finish. Working on projects across several days could cause you to forget what you were doing and what you need to do next. This happens to me often. Fortunately, you can make a program to help you remember!</p>
<p class="indent">The programs in this mission create a to-do list and display it in the Minecraft chat. You can use this program to keep track of your Minecraft goals so when you have to stop playing, you can easily pick up where you left off.</p>
<p class="indent">To make the to-do list, you’ll write two separate programs: one to write the list and the other to display the list. Let’s start by creating the program that writes the list.</p>
<h4 class="h4" id="ch11lev2sec06"><strong><span class="blue1">Part 1: Writing the To-Do List</span></strong></h4>
<p class="noindent">First, you need a program to create the items in the to-do list. <a href="ch11.xhtml#ch11ex1">Listing 11-1</a> starts you off, using a <span class="literal">while</span> loop and the <span class="literal">input()</span> function to add items to the to-do list. Copy it into a file in IDLE and save it as <em>inputToDoList.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span epub:type="pagebreak" id="page_240"></span><span class="blue"><em>inputToDoList.py</em></span></p>
<p class="programs"><span class="ent">➊</span> toDoFile =<br/><br/><span class="ent">➋</span> toDoList = <span class="green">""</span><br/><br/><span class="ent">➌</span> toDoItem = <span class="rose">input</span>(<span class="green">"Enter a to-do list item: "</span>)<br/><br/><span class="ent">➍</span> <span class="orange">while</span> toDoItem != <span class="green">"exit"</span>:<br/><span class="ent">➎</span>     toDoList = toDoList + toDoItem + <span class="green">"\n"</span><br/>       toDoItem = <span class="rose">input</span>(<span class="green">"Enter a to-do list item: "</span>)<br/><br/><span class="ent">➏</span> <span class="red"># Write the to-do list to the file</span><br/><span class="ent">➐</span> <span class="red"># Close the file</span></p>
<p class="examplet"><a id="ch11ex1"></a><em>Listing 11-1: The start of the program to write items in your to-do list</em></p>
<p class="indent">The program creates an empty string called <span class="literal">toDoList</span> <span class="ent">➋</span>, which will store all the items for your to-do list when you enter them. Using the <span class="literal">input()</span> function, the program then asks you to enter an item into the to-do list <span class="ent">➌</span>. The <span class="literal">while</span> loop then checks whether the input is not equal to <span class="literal">"exit"</span> <span class="ent">➍</span>; if it’s not, the program adds your item to the to-do list with a new line at the end using <span class="literal">"\n"</span> <span class="ent">➎</span>. However, if you enter <span class="literal">"exit"</span>, the loop no longer runs, and you won’t be able to add any more items to the to-do list.</p>
<p class="indent">Your mission is to finish the program. To do that, you need to write the code that opens the file, writes <span class="literal">toDoList</span> to the file, and then closes the file. Use the <span class="literal">open()</span> function to open the file at the start of the program <span class="ent">➊</span>. You should open it with write permissions. Name the file that the function opens <em>toDoList.txt</em>. Your program will create the file if it doesn’t already exist in the directory.</p>
<p class="indent">At the end of the program, write the contents of the to-do list to the file so you can access it later. Use the <span class="literal">write()</span> function to write the <span class="literal">toDoList</span> variable to the <span class="literal">toDoFile</span> ➏. After the file has been written to, make sure you close it with the <span class="literal">close()</span> function on the last line ➐.</p>
<p class="indent"><a href="ch11.xhtml#ch11fig1">Figure 11-1</a> shows me writing a to-do list with the program. When I’m finished, I type <span class="literal">exit</span>.</p>
<div class="image"><img alt="image" src="../images/f11-01.jpg"/></div>
<p class="figcap"><a id="ch11fig1"></a><em>Figure 11-1: Entering things to do, like build a cake forest and play hide-and-seek</em></p>
<h4 class="h4" id="ch11lev2sec07"><span epub:type="pagebreak" id="page_241"></span><strong><span class="blue1">Part 2: Displaying the To-Do List</span></strong></h4>
<p class="noindent">Now that you have a program to write a to-do list to a file, you need to display the to-do list in the Minecraft chat, one line at a time. <a href="ch11.xhtml#ch11ex2">Listing 11-2</a> starts the program for you. Copy the listing into a new file and save it as <em>outputToDoList.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>outputToDoList.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/><span class="ent">➊</span> toDoList =<br/><br/>   <span class="orange">for</span> line <span class="orange">in</span> toDoList:<br/><span class="ent">➋</span>     <span class="red"># Output "line" to the chat</span></p>
<p class="examplet"><a id="ch11ex2"></a><em>Listing 11-2: Program to output the to-do list file to the Minecraft chat</em></p>
<p class="indent"><a href="ch11.xhtml#ch11ex2">Listing 11-2</a> uses a <span class="literal">for</span> loop to output each line in the <em>toDoList.txt</em> file to the Minecraft chat, one at a time. At the moment, the program is incomplete. To finish the program, add the <span class="literal">open()</span> function to open the <em>toDoList.txt</em> file that you created with <em>inputToDoList.py</em> <span class="ent">➊</span>. Make sure the file has read permissions. After you open the file, add code inside the <span class="literal">for</span> loop to output the string stored in the <span class="literal">line</span> variable to Minecraft’s chat <span class="ent">➋</span>. You’ll have to use the <span class="literal">readline()</span> and <span class="literal">postToChat()</span> functions to do this.</p>
<p class="indent"><a href="ch11.xhtml#ch11fig2">Figure 11-2</a> shows my to-do list in the Minecraft chat.</p>
<div class="image"><img alt="image" src="../images/f11-02.jpg"/></div>
<p class="figcap"><a id="ch11fig2"></a><em>Figure 11-2: Now when I come back to building, I can see what I need to do.</em></p>
<h3 class="h3" id="ch11lev1sec02"><span epub:type="pagebreak" id="page_242"></span><strong><span class="blue1">Using Modules</span></strong></h3>
<p class="noindent"><em>Modules</em> are collections of functions that you can import into Python so you don’t have to write those functions in your programs. A module usually has a specific purpose, such as performing scientific calculations or making games, and a wide variety of modules are available for Python. You might be surprised to know that you’ve been using modules throughout this book! The Minecraft Python API is a module: every time you’ve written <span class="literal">from mcpi.minecraft import Minecraft</span>, you’ve been using a module. The Minecraft Python API module lets you connect your Python programs to Minecraft. Because it’s prewritten by someone else, you can use the module’s functions without having to write the code yourself.</p>
<p class="indent">Python comes with a bunch of modules that you can use in your programs. These modules, together with all the Python you’ve learned in this book so far, are called the <em>Python standard library</em>. You can also install modules that are not part of the standard library; we’ll do that in “<a href="ch11.xhtml#ch11lev1sec04">Installing New Modules with pip</a>” on <a href="ch11.xhtml#page_256">page 256</a>.</p>
<p class="indent">In this section, you’ll learn all the ways that you can set up your programs to use modules. As an example, we’ll use the <span class="literal">pickle</span> module, which provides more advanced ways to save and load data with files than just writing and reading data from them. Let’s look at the <span class="literal">pickle</span> module now.</p>
<h4 class="h4" id="ch11lev2sec08"><strong><span class="blue1">The pickle Module</span></strong></h4>
<p class="noindent">The <span class="literal">pickle</span> module is very useful when you’re writing complicated data to a file. For example, dictionaries and multidimensional lists are challenging to store and retrieve using the standard functions that we used earlier in the chapter. This is where the <span class="literal">pickle</span> module comes in handy.</p>
<p class="indent">The <span class="literal">pickle</span> module can save you hours of writing and debugging your own solutions for storing complex data. You can also use the <span class="literal">pickle</span> module on simple data: for example, you can use it to store numbers without converting them to and from strings, which is necessary for standard file input and output.</p>
<p class="indent">In other words, you can use the <span class="literal">pickle</span> module to save a variable’s value in a file and then read the variable’s value directly into another program without any extra processing. The data type remains the same as when you stored the value, even if the data type is a string, integer, float, or Boolean.</p>
<p class="indent">Next, you’ll learn how to import modules using <span class="literal">pickle</span> as an example. Then you’ll use <span class="literal">pickle</span> to save some complex data—an entire Minecraft building!</p>
<h4 class="h4" id="ch11lev2sec09"><strong><span class="blue1">Importing pickle</span></strong></h4>
<p class="noindent">To use any module’s functions, you need to import them by using the <span class="literal">import</span> keyword. Actually, you’ve already used the <span class="literal">import</span> keyword to import modules, such as the <span class="literal">time</span> module, as well as functions from the Python Minecraft API.</p>
<p class="indent"><span epub:type="pagebreak" id="page_243"></span>After you’ve imported the module into your program, you can use the module’s functions by using dot notation. Include the module name, a dot, and the function you want to use. Let’s import the <span class="literal">pickle</span> module and use a couple of its functions:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/><span class="ent">➋</span> secretFile= <span class="rose">open</span>(<span class="green">"secretFile.txt", "wb"</span>)<br/><span class="ent">➌</span> pickle.dump(locations, secretFile)</p>
<p class="indent">We import the <span class="literal">pickle</span> module at <span class="ent">➊</span>. Next we open <em>secretFile.txt</em> with a special file permission, <span class="literal">"wb"</span> <span class="ent">➋</span>. When you open a file with <span class="literal">pickle</span>, you must add <span class="literal">b</span> to the file permission. In this case, <span class="literal">"wb"</span> writes data to the file using a special format that the <span class="literal">pickle</span> module requires.</p>
<p class="indent">The <span class="literal">dump()</span> function writes to the file at <span class="ent">➌</span>. The <span class="literal">pickle</span> module’s <span class="literal">dump()</span> function stores a variable in a file. It takes two arguments: the data to be written to the file and the open file that it will write to. This example stores the locations of secret agents in a dictionary called <span class="literal">locations</span> and then dumps that dictionary in a file called <span class="literal">secretFile</span>. Because <span class="literal">dump()</span> belongs to the <span class="literal">pickle</span> module, you must use dot notation to specify both the module and the function with <span class="literal">pickle.dump()</span>. Unlike the standard file functions in Python, the <span class="literal">dump()</span> function saves the data to the file automatically—you don’t need to close the file with the <span class="literal">close()</span> function.</p>
<p class="indent">The <span class="literal">pickle</span> module also lets you read stored data. You can use <span class="literal">pickle</span>’s <span class="literal">load()</span> function to read the contents of a file. It takes one argument, the file that you want to load, and returns the contents of the file. The following example loads the <span class="literal">locations</span> dictionary we stored earlier. Add this code to the program:</p>
<p class="programs">   <span class="orange">import</span> pickle<br/><br/><span class="ent">➊</span> secretFile= <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"rb"</span>)<br/>   locations = pickle.load(secretFile)</p>
<p class="indent">First we open the file with the permission <span class="literal">"rb"</span> <span class="ent">➊</span>, which allows your program to read a special data format that <span class="literal">pickle</span> uses. Then we load the dictionary.</p>
<p class="indent">Now that the dictionary has been loaded, you can treat it like any other dictionary. For example, you can access the value of one of the keys. Just add this code after the <span class="literal">pickle.load()</span> function:</p>
<p class="programs"><span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">This will print <span class="literal">'Mountains'</span>, the value of the <span class="literal">'Phillipa'</span> key. That’s because the dictionary in the file is unchanged when it’s loaded into the <span epub:type="pagebreak" id="page_244"></span>program with <span class="literal">pickle</span>—it’s still a dictionary, so we can access its keys and values and use it just like any other Python dictionary. You could do the same with a list or a variable as well.</p>
<h4 class="h4" id="ch11lev2sec10"><strong><span class="blue1">Importing One Function with the from Clause</span></strong></h4>
<p class="noindent">Importing a module means you have access to all the functions in that module, but sometimes you need only one function in a module. If you want to import just one function, you use the <span class="literal">from</span> clause when you import the module. This clause lets you access the function without including the module name and dot notation every time you call a function. You would just write <span class="literal">function()</span> instead of <span class="literal">module.function()</span>.</p>
<p class="indent">Sometimes when you use the <span class="literal">pickle</span> module you might want to use only the <span class="literal">dump()</span> function, not its other functions. To do this, change the code that you wrote earlier so it looks like this:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> dump<br/><br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)</p>
<p class="indent">The first line uses the <span class="literal">from</span> clause to import only the <span class="literal">dump()</span> function from the <span class="literal">pickle</span> module <span class="ent">➊</span>. The last line calls the <span class="literal">dump()</span> function <span class="ent">➋</span>. Notice that it doesn’t have dot notation. You just call the function name without referencing the module name.</p>
<p class="indent">You can also import more than one function from a module using <span class="literal">from</span>. All you need to do is separate the function names with a comma. For example, if you want to use the <span class="literal">dump()</span> and <span class="literal">load()</span> functions from <span class="literal">pickle</span> in the same file, you could import them both:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> dump, load<br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)<br/><br/><span class="ent">➌</span> locations = load(secretFile)<br/>   <span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">The first line uses the <span class="literal">from</span> clause with commas to import both the <span class="literal">dump()</span> and <span class="literal">load()</span> functions <span class="ent">➊</span>. This means that later in the program, you can use these functions without having to include the function name and dot notation, which you can see at <span class="ent">➋</span> and <span class="ent">➌</span>.</p>
<h4 class="h4" id="ch11lev2sec11"><span epub:type="pagebreak" id="page_245"></span><strong><span class="blue1">Importing All Functions with *</span></strong></h4>
<p class="noindent">You can also import all the functions in a module so you don’t need to include the name of the module with dot notation every time you use it. You do this by entering an asterisk (<span class="literal">*</span>) at the end of the <span class="literal">import</span> statement, like this:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> *<br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)<br/><br/><span class="ent">➌</span> locations = load(secretFile)<br/>   <span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">Because this code imported all the functions in the module using an asterisk <span class="ent">➊</span>, we don’t need to use dot notation when we call the <span class="literal">dump()</span> <span class="ent">➋</span> and <span class="literal">load()</span> <span class="ent">➌</span> functions.</p>
<p class="indent">The <span class="literal">*</span> option is very handy, but it comes with a risk! If you’re working with multiple modules, two modules might share the same function names. When this happens, Python will get confused and you might get an error. So when you’re working with many modules, it’s best to avoid using the <span class="literal">*</span> option and instead import only the functions you need to use.</p>
<h4 class="h4" id="ch11lev2sec12"><strong><span class="blue1">Giving a Module a Nickname</span></strong></h4>
<p class="noindent">Sometimes you’ll want to rename a module because its name is too long and you want to use a shorter name in your program. Or, you want to change the module’s name to make it easier to remember. Or, perhaps you want to change its name because the module shares the same name as another module and you want to avoid conflicts.</p>
<p class="indent">You can use the <span class="literal">as</span> clause with the <span class="literal">import</span> statement to give a module an <em>alias</em>—a nickname. For example, this code imports the <span class="literal">pickle</span> module and renames it to <span class="literal">p</span>:</p>
<p class="programs"><span class="orange">import</span> pickle as p</p>
<p class="indent">Now, every time you want to use the <span class="literal">pickle</span> module, you can write <span class="literal">p</span> in your program instead of <span class="literal">pickle</span>. Here’s an example of this in action:</p>
<p class="programs">p.dump(locations, secretFile)</p>
<p class="indent">Notice that <span class="literal">p.dump()</span> is used instead of <span class="literal">pickle.dump()</span>. This saves you time because you don’t have to keep typing <span class="literal">pickle</span>!</p>
<h4 class="h4a" id="ch11lev2sec13"><span epub:type="pagebreak" id="page_246"></span><strong>Mission #65: Save a Building</strong></h4>
<p class="noindent">Building things is my favorite part of Minecraft. I’ve spent hours building houses, castles, villages, and so many other things. But when I move to another part of the map or to a different world, I have to leave my creations behind. I’m sure you’ve also had to abandon some awesome creations.</p>
<p class="indent">Wouldn’t it be cool if you could save your buildings and take them with you when you move into different worlds? Well, with <span class="literal">pickle</span> and the Python API, you can!</p>
<p class="indent">In this mission, you’ll develop two programs that will save and load buildings into your Minecraft game. One program will store the building, and the other will load the building. Both programs build on <em>duplicateArea.py</em> from <a href="ch10.xhtml#ch10">Chapter 10</a> (<a href="ch10.xhtml#page_229">page 229</a>).</p>
<h4 class="h4" id="ch11lev2sec14"><strong><span class="blue1">Part 1: Saving the Building</span></strong></h4>
<p class="noindent">The first program will save a building into a file. <a href="ch11.xhtml#ch11ex3">Listing 11-3</a> includes the code to copy the building. Copy the listing into a file in IDLE and save it as <em>saveStructure.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>saveStructure.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/>   <span class="orange">import</span> pickle<br/><br/><br/>   <span class="orange">def</span> <span class="blue1">sortPair</span>(val1, val2):<br/>       <span class="orange">if</span> val1 &gt; val2:<br/>           <span class="orange">return</span> val2, val1<br/>       <span class="orange">else</span>:<br/>           <span class="orange">return</span> val1, val2<br/><br/><br/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">copyStructure</span>(x1, y1, z1, x2, y2, z2):<br/>       x1, x2 = sortPair(x1, x2)<br/>       y1, y2 = sortPair(y1, y2)<br/>       z1, z2 = sortPair(z1, z2)<br/><br/>       width = x2 - x1<br/>       height = y2 - y1<br/>       length = z2 - z1<br/><br/>       structure = []<br/><br/>       <span class="rose">print</span>(<span class="green">"Please wait..."</span> )<br/><br/>       <span class="red"># Copy the structure</span><br/>       <span class="orange">for</span> row <span class="orange">in</span> <span class="rose">range</span>(height):<br/>           structure.append([])<br/>           <span class="orange">for</span> column <span class="orange">in</span> <span class="rose">range</span>(width):<br/>               structure[row].append([])<br/>               <span class="orange">for</span> depth <span class="orange">in</span> <span class="rose">range</span>(length):<br/><span class="ent">➋</span>                 block = mc.getBlock(x1 + column, y1 + row, z1 + depth)<br/>                   structure[row][column].append(block)<br/><br/>       <span class="orange">return</span> structure<br/><br/><span class="ent">➌</span> <span class="red"># Get the position of the first corner</span><br/>   <span class="rose">input</span>(<span class="green">"Move to the first position and press ENTER in this window"</span>)<br/>   pos1 = mc.player.getTilePos()<br/><br/>   x1 = pos1.x<br/>   y1 = pos1.y<br/>   z1 = pos1.z<br/><br/><span class="ent">➍</span> <span class="red"># Get the position of the second corner</span><br/>   <span class="rose">input</span>(<span class="green">"Move to the opposite corner and press ENTER in this window"</span>)<br/>   pos2 = mc.player.getTilePos()<br/><br/>   x2 = pos2.x<br/>   y2 = pos2.y<br/>   z2 = pos2.z<br/><br/><span class="ent">➎</span> structure = copyStructure( x1, y1, z1, x2, y2, z2)<br/><br/><span class="ent">➏</span> <span class="red"># Store the structure in a file</span></p>
<p class="examplet"><span epub:type="pagebreak" id="page_247"></span><a id="ch11ex3"></a><em>Listing 11-3: Incomplete code to store a building in a file</em></p>
<p class="indent">The <span class="literal">copyStructure()</span> function copies an area in the game into a set of three-dimensional lists <span class="ent">➊</span>. It takes two sets of coordinates as arguments. I’ve made a slight change in the <span class="literal">copyStructure()</span> function compared to <em>duplicateArea.py</em>. I’ve used the <span class="literal">getBlockWithData()</span> function instead of the <span class="literal">getBlock()</span> function <span class="ent">➋</span>. Rather than getting just the block ID for a block at certain coordinates, the <span class="literal">getBlockWithData()</span> function also gets the block’s state. This is useful for blocks like stairs, where the direction of the stairs is stored in the block state. When the structure is copied, stairs and other blocks that face a certain way will be built in the correct direction.</p>
<p class="indent">I’ve included some neat code so you can use the player’s position to set the coordinates of a building you want to copy. When you run the program, it asks you to move to the first corner of the structure and then press <small>ENTER</small> in the Python shell <span class="ent">➌</span>. The program uses the player’s position to get the first set of coordinates for the building. Next, it asks you to move to the opposite corner of the structure and do the same <span class="ent">➍</span>. As a result, you can just stand where you want to start copying your building instead of writing coordinates or hard-coding them into your program.</p>
<p class="indent">The values of these coordinate variables are passed to the function <span class="literal">copyStructure()</span> at <span class="ent">➎</span>. The returned value is stored in a variable called <span class="literal">structure</span>.</p>
<p class="indent">To complete the code, you need to open a new file with <span class="literal">pickle</span>. Call the new file <span class="literal">"pickleFile"</span>. Then write the code to store the building in the file. Do this by using the <span class="literal">pickle</span> module to write the value of the <span class="literal">structure</span> variable to a file ➏.</p>
<p class="indent"><span epub:type="pagebreak" id="page_248"></span><a href="ch11.xhtml#ch11fig3">Figure 11-3</a> shows a tower that I built in my Minecraft world.</p>
<div class="image"><img alt="image" src="../images/f11-03.jpg"/></div>
<p class="figcap"><a id="ch11fig3"></a><em>Figure 11-3: My tower that I want to copy</em></p>
<p class="indent">To copy the tower using <em>saveStructure.py</em>, I move to one corner and press <small>ENTER</small> in IDLE (<a href="ch11.xhtml#ch11fig4">Figure 11-4</a>).</p>
<div class="image"><img alt="image" src="../images/f11-04.jpg"/></div>
<p class="figcap"><a id="ch11fig4"></a><em>Figure 11-4: Standing next to one corner of the tower</em></p>
<p class="indent">Then I fly to the opposite corner of the tower and press <small>ENTER</small> in IDLE a second time (<a href="ch11.xhtml#ch11fig5">Figure 11-5</a>).</p>
<div class="image"><span epub:type="pagebreak" id="page_249"></span><img alt="image" src="../images/f11-05.jpg"/></div>
<p class="figcap"><a id="ch11fig5"></a><em>Figure 11-5: Flying to the opposite corner of the tower</em></p>
<p class="indent">Follow the same steps to use <em>saveStructure.py</em> to save one of your own buildings. Next we’ll complete the other half of the process and load our saved buildings into the game.</p>
<h4 class="h4" id="ch11lev2sec15"><strong><span class="blue1">Part 2: Loading the Building</span></strong></h4>
<p class="noindent">The second program needs to load the building into the game from the file (named <em>pickleFile</em>) created by <em>saveStructure.py</em>. <a href="ch11.xhtml#ch11ex4">Listing 11-4</a> includes code from the <em>duplicateArea.py</em> program (<a href="ch10.xhtml#page_229">page 229</a>) that places a building stored in lists. Copy the listing into a file in IDLE and save it as <em>loadStructure.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>loadStructure.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/>   <span class="orange">import</span> pickle<br/><br/><br/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">buildStructure</span>(x, y, z, structure):<br/>       xStart = x<br/>       zStart = z<br/>       <span class="orange">for</span> row <span class="orange">in</span> structure:<br/>           <span class="orange">for</span> column <span class="orange">in</span> row:<br/>               <span class="orange">for</span> block <span class="orange">in</span> column:<br/>                   mc.setBlock(x, y, z, block.id, block.data)<br/>                   z += 1<br/>               x += 1<br/>               z = zStart<br/>           y += 1<br/>           x = xStart<br/><br/>   <span class="red"># Open and load the structure file</span><br/><span class="ent">➋</span> structure =<br/><br/><span class="ent">➌</span> pos = mc.player.getTilePos()<br/>   x = pos.x<br/>   y = pos.y<br/>   z = pos.z<br/><span class="ent">➍</span> buildStructure(x, y, z, structure)</p>
<p class="examplet"><span epub:type="pagebreak" id="page_250"></span><a id="ch11ex4"></a><em>Listing 11-4: When complete, this program will build a building from a file.</em></p>
<p class="indent">The <span class="literal">buildStructure()</span> function <span class="ent">➊</span> does most of the work in this program. It builds the structure in the game using four arguments: x-, y-, and z-coordinates and a structure stored in a three-dimensional list.</p>
<p class="indent">Import the <span class="literal">pickle</span> module so you can load the structure into the program, and then store it in the <span class="literal">structure</span> variable at <span class="ent">➋</span>. Using the <span class="literal">open()</span> function, open the <em>pickleFile</em> file that you saved the structure into. Then load it into the <span class="literal">structure</span> variable using <span class="literal">pickle</span>’s <span class="literal">load()</span> function. After the structure has been loaded, close <em>pickleFile</em> using <span class="literal">pickle</span>’s <span class="literal">close()</span> function.</p>
<p class="indent">Also included in <a href="ch11.xhtml#ch11ex4">Listing 11-4</a> is some code that gets the player’s position to use as the starting location for the structure <span class="ent">➌</span>.</p>
<p class="indent">After the structure is loaded and the coordinates are set, pass the structure to the <span class="literal">buildStructure()</span> function along with a position <span class="ent">➍</span>, which will build the saved structure.</p>
<p class="indent"><a href="ch11.xhtml#ch11fig6">Figure 11-6</a> shows the program in action. The building I saved earlier has been loaded into the game and rebuilt at a new position. Try it yourself—now you have the ability to take your creations with you wherever you go!</p>
<div class="image"><img alt="image" src="../images/f11-06.jpg"/></div>
<p class="figcap"><a id="ch11fig6"></a><em>Figure 11-6: Look, it’s a copy of my tower!</em></p>
<p class="indent">But what if you create a whole village and want to take it with you? You could save each building in its own file using <span class="literal">pickle</span>, but that’s not very convenient. The <span class="literal">pickle</span> module works great for saving a single building, but it’s not so good for saving a bunch of buildings. That’s where the <span class="literal">shelve</span> module comes in. Let’s look at that next.</p>
<h3 class="h3" id="ch11lev1sec03"><span epub:type="pagebreak" id="page_251"></span><strong><span class="blue1">Storing Lots of Data with the shelve Module</span></strong></h3>
<p class="noindent">The <span class="literal">pickle</span> module can store only one piece of data at a time. In some programs, you might want to store several variables; if you use the <span class="literal">pickle</span> module, you’ll need to create several files, which can be difficult to manage.</p>
<p class="indent">Python’s <span class="literal">shelve</span> module solves this problem. It can store several items of data in a single file. It works like a dictionary in which each data value has a key that you can use to store and retrieve the data. Think of <span class="literal">shelve</span> like a shelf: each compartment in the shelf stores different data values.</p>
<h4 class="h4" id="ch11lev2sec16"><strong><span class="blue1">Opening a File with shelve</span></strong></h4>
<p class="noindent">After importing the <span class="literal">shelve</span> module, you’ll use its <span class="literal">open()</span> function to open a file. If the file doesn’t already exist, a new one will be created.</p>
<p class="indent">The following code opens the <em>locationsFile.db</em> file and stores it in the <span class="literal">shelveFile</span> variable:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">"locationsFile.db"</span>)</p>
<p class="indent">The <span class="literal">open()</span> function takes only one argument, the name of the file. You don’t need to specify file permissions when you use the <span class="literal">shelve</span> module because it automatically grants read-and-write privileges.</p>
<p class="indent">When naming a file with the <span class="literal">shelve</span> module, you must include the <em>.db</em> extension at the end of the filename. You can see the <em>.db</em> at the end of my <em>locationsFile.db</em> file.</p>
<h4 class="h4" id="ch11lev2sec17"><strong><span class="blue1">Adding, Modifying, and Accessing Items with shelve</span></strong></h4>
<p class="noindent">The <span class="literal">shelve</span> module works like a dictionary. To add data to the file, you use square brackets with a key name to store a value. For example, let’s say a secret agent named Beatrice is on a submarine, and we want to store Beatrice’s location in the <span class="literal">shelveFile</span> dictionary:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">"locationsFile.db"</span>)<br/>shelveFile[<span class="green">'Beatrice'</span>] = <span class="green">'Submarine'</span><br/>shelveFile.close()</p>
<p class="indent">First we open the file. Next, we give the <span class="literal">shelveFile</span> dictionary a key of <span class="literal">'Beatrice'</span> and the value <span class="literal">'Submarine'</span>. This line creates a new item in the <span class="literal">shelveFile</span> dictionary with the key <span class="literal">'Beatrice'</span> and the value <span class="literal">'Submarine'</span>.</p>
<p class="indent">Then we use <span class="literal">shelve</span>’s <span class="literal">close()</span> function to add the new data to the file and safely close the file.</p>
<p class="indent"><span epub:type="pagebreak" id="page_252"></span>If a key already exists in a shelve file, this code would update the old value to the new value. Let’s say that Beatrice finishes her mission and returns to headquarters. You could update Beatrice’s location like this:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">'locationsFile.db'</span>)<br/>shelveFile[<span class="green">'Beatrice'</span>] = <span class="green">'Headquarters'</span><br/>shelveFile.close()</p>
<p class="indent">Now the corresponding value of the Beatrice key is <span class="literal">'Headquarters'</span>. Accessing a value from <span class="literal">shelve</span> works just like a dictionary, too. You use keys to access specific values. For example, to print Beatrice’s location, we’d use the following code:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">'locationsFile.db'</span>)<br/><span class="rose">print</span>(shelveFile[<span class="green">'Beatrice'</span>])</p>
<p class="indent">This will output Beatrice’s location, <span class="literal">Headquarters</span>.</p>
<p class="indent">Just like a standard dictionary, the <span class="literal">shelve</span> module can store any data type, including floats, strings, Booleans, multidimensional lists, other dictionaries, and so on. In fact, in the next mission you’ll store and access multidimensional lists to save and load multiple structures!</p>
<h4 class="h4a" id="ch11lev2sec18"><strong>Mission #66: Save a Collection of Structures</strong></h4>
<p class="noindent">The programs in this mission will store and load all of your saved structures using a single file. This mission is once again divided into two programs: one for saving and the other for loading.</p>
<p class="indent">You’ll need to convert the programs from Mission #65 to use the <span class="literal">shelve</span> module instead of the <span class="literal">pickle</span> module. You’ll also add code to take user input so users can name their buildings. Open the <em>saveStructure.py</em> and <em>loadStructure.py</em> files and save them as <em>saveCollection.py</em> and <em>loadCollection.py</em>.</p>
<p class="indent">As we did in the previous mission, let’s make the changes to these programs in two parts.</p>
<h4 class="h4" id="ch11lev2sec19"><strong><span class="blue1">Part 1: Saving a Structure to a Collection</span></strong></h4>
<p class="noindent">Part of the original <em>saveStructure.py</em> file is included and annotated here to help identify where you’ll make the changes. Here’s the first line and the last few lines of <em>saveCollection.py</em>:</p>
<p class="sidenote"><span class="blue"><em>saveCollection.py</em></span></p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>--<span class="codeitalic">snip</span>--<br/><br/>   <span class="red"># Name the structure</span><br/><span class="ent">➋</span> structureName = <span class="rose">input</span>(<span class="green">"What do you want to call the structure?"</span>)<br/>   <span class="red"># Store the structure in a file</span><br/><span class="ent">➌</span> pickleFile = <span class="rose">open</span>(<span class="green">"pickleFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➍</span> pickleFile.dump(structure)</p>
<p class="indent"><span epub:type="pagebreak" id="page_253"></span>An extra line is added to the file to ask what you want to call the structure when you save it with <span class="literal">pickle</span> <span class="ent">➋</span>. For example, my version of the program asks “What do you want to call the structure?” and I can reply with something like “House” or “Cake forest.” Make sure you call each new structure by a different name; if a new structure has the same name as another one, the old structure will be overwritten by the new one.</p>
<p class="indent">To change this program to use the <span class="literal">shelve</span> module instead of <span class="literal">pickle</span>, you need to make two changes. First, swap the module import from <span class="literal">pickle</span> to <span class="literal">shelve</span> <span class="ent">➊</span>. Second, change the last few lines of the code to use <span class="literal">shelve</span> instead of <span class="literal">pickle</span>. Open a file called <em>structuresFile.db</em> and store it in a variable called <span class="literal">shelveFile</span> using the <span class="literal">shelve.open()</span> function <span class="ent">➌</span>. Then store the <span class="literal">structure</span> variable in a <span class="literal">shelve</span> dictionary using the <span class="literal">structureName</span> variable for the name of the dictionary’s key <span class="ent">➍</span>. It should look something like this: <span class="literal">shelveFile[structureName] = structure</span>. Finally, close <span class="literal">shelveFile</span> on the last line by using <span class="literal">close()</span>.</p>
<h4 class="h4" id="ch11lev2sec20"><strong><span class="blue1">Part 2: Loading a Structure from a Collection</span></strong></h4>
<p class="noindent">Now you need to change the <em>loadCollection.py</em> file. I’ve removed the middle of the file to save space here and to make the bits you need to change easier to see:</p>
<p class="sidenote"><span class="blue"><em>loadCollection.py</em></span></p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>--<span class="codeitalic">snip</span>--<br/><span class="ent">➋</span> structure = pickle.load(<span class="green">"pickleFile"</span>)<br/><span class="ent">➌</span> structureName = <span class="rose">input</span>(<span class="green">"Enter the structure's name"</span>)<br/><br/>   pos = mc.player.getTilePos()<br/>   x = pos.x<br/>   y = pos.y<br/>   z = pos.z<br/><br/><span class="ent">➍</span> buildStructure(x, y, z, structureDictionary[structureName])</p>
<p class="indent">I’ve added an extra line to the code that asks for the name of the structure you want to build <span class="ent">➌</span>. Also, I added a bit of code to the last line that gets the structure from the <span class="literal">shelve</span> dictionary and passes it to the <span class="literal">buildStructure()</span> function.</p>
<p class="indent">You need to make a couple of changes to this program. First, as in <em>saveCollection.py</em>, change <span class="literal">import</span> to <span class="literal">shelve</span> instead of <span class="literal">pickle</span> <span class="ent">➊</span>. Second, load the <span class="literal">shelveFile</span> that you created in <em>saveCollection.py</em> by using <span class="literal">shelve.open()</span> <span class="ent">➋</span>. Store the data returned by the <span class="literal">shelve.open()</span> function in the variable <span epub:type="pagebreak" id="page_254"></span><span class="literal">structureDictionary</span> <span class="ent">➍</span>. The code should look something like the following: <span class="literal">structureDictionary = shelve.load("shelveFile")</span>.</p>
<p class="indent">All of the data for the structures, including their names and blocks, are stored in the <em>structuresFile.db</em> file, which means you don’t need to make any changes to <em>loadCollection.py</em> before you run it. All you need to do is enter the name of the structure that you want to use when you run the program.</p>
<p class="indent">Let’s see the program in action, using a structure from my Minecraft world. First, I copy the structure using <em>saveCollection.py</em> by flying to one corner of the structure and pressing <small>ENTER</small> (<a href="ch11.xhtml#ch11fig7">Figure 11-7</a>).</p>
<div class="image"><img alt="image" src="../images/f11-07.jpg"/></div>
<p class="figcap"><a id="ch11fig7"></a><em>Figure 11-7: I move to one corner of the structure I want to save.</em></p>
<p class="indent">Next, I fly to the opposite corner of the structure and press <small>ENTER</small> again (<a href="ch11.xhtml#ch11fig8">Figure 11-8</a>).</p>
<div class="image"><img alt="image" src="../images/f11-08.jpg"/></div>
<p class="figcap"><a id="ch11fig8"></a><em>Figure 11-8: I move to the opposite corner.</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_255"></span>Then the program prompts me to enter a name for my structure. <a href="ch11.xhtml#ch11fig9">Figure 11-9</a> shows that I’ve called my structure <span class="literal">"Cake tree"</span>.</p>
<div class="image"><img alt="image" src="../images/f11-09.jpg"/></div>
<p class="figcap"><a id="ch11fig9"></a><em>Figure 11-9: I enter the name that I want to save the structure as.</em></p>
<p class="indent">Finally, I run <em>loadCollection.py</em>, fly to the location where I want to build a copy of the structure, and enter the name of the structure I want to build (<a href="ch11.xhtml#ch11fig10">Figure 11-10</a>). The program starts building in front of me, just like magic!</p>
<div class="image"><img alt="image" src="../images/f11-10.jpg"/></div>
<p class="figcap"><a id="ch11fig10"></a><em>Figure 11-10: Now when I want to create a copy, I just enter the name of the structure and it builds.</em></p>
<p class="indent">You can repeat this process with as many buildings or structures as you want; for example, I’ve made a copy of a hut in <a href="ch11.xhtml#ch11fig11">Figure 11-11</a>. After you’ve copied a structure once, you can load it anytime you want just by running <em>loadCollection.py</em> and entering the structure’s name!</p>
<div class="image"><span epub:type="pagebreak" id="page_256"></span><img alt="image" src="../images/f11-11.jpg"/></div>
<p class="figcap"><a id="ch11fig11"></a><em>Figure 11-11: You can use the program to save multiple structures. Here I’ve copied a hut.</em></p>
<h3 class="h3" id="ch11lev1sec04"><strong><span class="blue1">Installing New Modules with pip</span></strong></h3>
<p class="noindent">In addition to <span class="literal">pickle</span> and <span class="literal">shelve</span>, you can import thousands of other modules to use in your Python programs. With so many modules available, correctly installing them is very important. To simplify installing modules, Python provides a package manager called pip. A <em>package manager</em> is software that has a database of other software that you can install on your computer. It also includes features that make it straightforward to install, upgrade, and uninstall the other software.</p>
<p class="indent">The pip package manager can install, upgrade, and remove packages in Python. It also has a large collection of modules that you can use in Python. This section shows you how to install a package using pip and showcases the <span class="literal">Flask</span> module, which you can use to build a website!</p>
<p class="indent">If you’re using the most recent version of Python 3, pip is preinstalled. If you’re using an earlier version of Python, pip may not be installed. The easiest way to get pip is to install the latest version of Python. (See “<a href="ch01.xhtml#ch01lev2sec02">Installing Python</a>” on <a href="ch01.xhtml#page_3">page 3</a> for Windows and on <a href="ch01.xhtml#page_15">page 15</a> for Mac.)</p>
<p class="indent">Let’s look at how to use pip. Depending on the operating system you use, you can use pip in a couple of ways. Be sure to follow the instructions that match your computer!</p>
<h4 class="h4" id="ch11lev2sec21"><strong><span class="blue1">Using pip on Windows</span></strong></h4>
<p class="noindent">When using pip on Windows, you need to open the Windows command prompt. The command prompt is similar to the Python shell. It lets you input a single command on a line, which runs when you press <small>ENTER</small>.</p>
<p class="indent">To open the command prompt, press the Windows key or open the Start menu and search for <span class="literal">cmd</span>. When you open the program, you’ll see a black window (<a href="ch11.xhtml#ch11fig12">Figure 11-12</a>).</p>
<div class="image"><span epub:type="pagebreak" id="page_257"></span><img alt="image" src="../images/f11-12.jpg"/></div>
<p class="figcap"><a id="ch11fig12"></a><em>Figure 11-12: The Windows command prompt</em></p>
<p class="indent">To use pip in the command prompt, type <span class="literal">pip</span> followed by the action you want it to take. For example, let’s install the Python module <span class="literal">Flask</span>, which you can use to make websites with Python. Enter the following command in the command prompt:</p>
<p class="programs">&gt; <span class="codestrong">pip install Flask</span></p>
<p class="indent">On the Python Package index website at <em><a href="http://pypi.python.org/">http://pypi.python.org/</a></em>, you can find many other Python modules that you can install.</p>
<h4 class="h4" id="ch11lev2sec22"><strong><span class="blue1">Using pip on a Mac or Raspberry Pi</span></strong></h4>
<p class="noindent">If you’re using pip on a Mac or a Raspberry Pi, you’ll need to include <span class="literal">sudo</span> at the start of the command to get it to work. For example, enter this line:</p>
<p class="programs">$ <span class="codestrong">sudo pip install Flask</span></p>
<p class="indent">If you get an error, flip to <a href="ch01.xhtml#ch01">Chapter 1</a> to double-check the Mac or Raspberry Pi installation instructions.</p>
<p class="indent">On the Python Package index website at <em><a href="http://pypi.python.org/">http://pypi.python.org/</a></em>, you can find many other Python modules that you can install.</p>
<h3 class="h3" id="ch11lev1sec05"><strong><span class="blue1">Using a Module from pip: Flask</span></strong></h3>
<p class="noindent"><span class="literal">Flask</span> is a Python module that you can use to develop websites. In this section, you’ll learn how to set up a basic <span class="literal">Flask</span> website and then integrate the website with Minecraft so you can display your player’s position on a website!</p>
<p class="indent">With <span class="literal">Flask</span>, you need only a few lines of code to make and manage a website. You just write the Python code as you normally would and add <span epub:type="pagebreak" id="page_258"></span>some extra information related to <span class="literal">Flask</span>. Next, you run your code, and it makes a website that your computer can access. You can then view the web-site in your web browser.</p>
<p class="indent"><a href="ch11.xhtml#ch11ex5">Listing 11-5</a> creates a basic <span class="literal">Flask</span> website that includes the most important piece of information about me: my name.</p>
<p class="sidenote"><span class="blue"><em>namePage.py</em></span></p>
<p class="programs">   <span class="orange">from</span> flask <span class="orange">import</span> Flask<br/><span class="ent">➊</span> app = Flask(__name__)<br/><br/><span class="ent">➋</span> @app.route(<span class="green">"/"</span>)<br/>   <span class="orange">def</span> <span class="blue1">showName</span>():<br/><span class="ent">➌</span>     <span class="orange">return</span> <span class="green">"Craig Richardson"</span><br/><br/><span class="ent">➍</span> app.run()</p>
<p class="examplet"><a id="ch11ex5"></a><em>Listing 11-5: A Python program that uses</em> <span class="literal"><span class="codeitalic">Flask</span></span> <em>to create a website</em></p>
<p class="indent">To use <span class="literal">Flask</span>, you first need to create <span class="literal">Flask</span> using the <span class="literal">Flask()</span> function <span class="ent">➊</span>. The <span class="literal">__name__</span> argument tells <span class="literal">Flask</span> that your <span class="literal">Flask</span> project is contained in this file, and it doesn’t need to look anywhere else to find other parts of the program. Note the two underscores, not one, at the start and at the end of the <span class="literal">__name__</span> argument.</p>
<p class="indent">The <span class="literal">@app.route()</span> tag uses a decorator. <em>Decorators</em> provide additional information to Python about your functions. For example, in this program the <span class="literal">@app.route()</span> decorator tells <span class="literal">Flask</span> which part of the website the function will be used on. In this case, <span class="literal">"/"</span> tells <span class="literal">Flask</span> the <span class="literal">showName()</span> function will be used on the home page <span class="ent">➋</span>. The <span class="literal">return</span> statement in the function tells <span class="literal">Flask</span> what will be displayed on the page. In this example, it returns my name, so my name will be displayed on the page <span class="ent">➌</span>. The last line of the program tells Python to start <span class="literal">Flask</span> when this file is run <span class="ent">➍</span>.</p>
<p class="indent">Save this file as <em>namePage.py</em> in the <em>files</em> folder. Add your own text to make your own website.</p>
<p class="indent">To run the website, click <strong>Run</strong> <img alt="image" src="../images/arrow.jpg"/> <strong>Run Module</strong> in IDLE. The program runs and generates a website file that you can open in a web browser. To find the location of the website, you need to read the line of code that your program outputs when you start running it. When I run the program, the output looks like this:</p>
<p class="programs"><span class="blue1">* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</span></p>
<p class="indent">From this line, I can tell that entering <em>http://127.0.0.1:5000/</em> into a web browser will take me to the <span class="literal">Flask</span> website that I just started running. Now when I open the web browser and go to this site, I can see my name displayed on the page (<a href="ch11.xhtml#ch11fig13">Figure 11-13</a>).</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>The website you create in this program is available only on your computer at the moment. Only you can access this website—nobody else on the Internet can look at it.</em></p>
</div>
<div class="image"><span epub:type="pagebreak" id="page_259"></span><img alt="image" src="../images/f11-13.jpg"/></div>
<p class="figcap"><a id="ch11fig13"></a><em>Figure 11-13: Look at my website! You can change what’s displayed here to whatever you want. What will you write on your website?</em></p>
<p class="indent">To stop the program, go into IDLE and press <small>CTRL</small>-C or click <strong>Shell</strong> <img alt="image" src="../images/arrow.jpg"/> <strong>Restart Shell</strong>.</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>This chapter covers only a very basic introduction to</em> <span class="literal"><span class="codeitalic">Flask</span></span>. <span class="literal"><span class="codeitalic">Flask</span></span> <em>is very useful to learn because it allows you to build interactive websites quickly with Python. If you want to know more about</em> <span class="literal"><span class="codeitalic">Flask</span></span><em>, check out this tutorial on the</em> <span class="literal"><span class="codeitalic">Flask</span></span> <em>website at</em> <a href="http://flask.pocoo.org/docs/0.10/tutorial/">http://flask.pocoo.org/docs/0.10/tutorial/</a>.</p>
</div>
<h4 class="h4a" id="ch11lev2sec23"><strong>Mission #67: Position Website</strong></h4>
<p class="noindent">One of Python’s best qualities is that it’s easy to integrate the features of different modules into a single program. You’ve been using the Minecraft Python API module throughout the book and have just learned about the <span class="literal">Flask</span> module. With just a few steps you can integrate the two.</p>
<p class="indent">In this mission, you’ll combine the Minecraft Python API with <span class="literal">Flask</span> to display a player’s position on a web page.</p>
<p class="indent">Create a new file in IDLE and save it as <em>positionPage.py</em> in the <em>files</em> folder. You need to get the player’s position from Minecraft and display it on the web page using a function with the <span class="literal">Flask @app.route("/")</span> tag. You can base the code on the example in <a href="ch11.xhtml#ch11ex5">Listing 11-5</a>. Make the code display the position in the format <span class="literal">"x 10, y 110, z 12"</span>.</p>
<p class="indent">Run the program and check out your web page. Pretty cool, huh? Using <span class="literal">Flask</span> you can create web pages with all kinds of information on them. You can even upload these pages to the Internet to share with your friends!</p>
<h3 class="h3" id="ch11lev1sec06"><span epub:type="pagebreak" id="page_260"></span><strong><span class="blue1">What You Learned</span></strong></h3>
<p class="noindent">In this chapter, you were introduced to using files with Python. You learned how to read and write to files using Python’s standard library, giving you control over files when you create your own programs. You also learned how to use modules, which extend Python’s capabilities and what you can do in Python.</p>
<p class="indent">You explored the <span class="literal">pickle</span> module, the <span class="literal">shelve</span> module, and the pip package manager. The <span class="literal">pickle</span> and <span class="literal">shelve</span> modules are used for different purposes. The <span class="literal">pickle</span> module saves the value of a single variable, especially when it contains a multidimensional list or dictionary, which would be difficult to store and open using the standard library. The <span class="literal">shelve</span> module has the same strengths as the <span class="literal">pickle</span> module, but it gives you more flexibility to store several values at once in a dictionary-like structure. With pip, you learned how to install new modules. You were also introduced to the <span class="literal">Flask</span> module, which is a quick and flexible way to build websites with Python.</p>
<p class="indent">With this knowledge, you completed four missions. The first allowed you to create to-do lists, which you can display in the Minecraft game to remind you what you’re working on. The second made it possible to save buildings and load them into your current world and other worlds. The third mission modified the second mission so you could store all your buildings in a single file instead of a file for each building. The final mission showed you how to use the <span class="literal">Flask</span> module to create a web page that displays the player’s current position.</p>
<p class="indent">You’ve done a great job so far! The next chapter is the final chapter. You’ll learn about classes and object-oriented programming, a popular programming style that allows you to reuse code.</p>
</body>
</html>